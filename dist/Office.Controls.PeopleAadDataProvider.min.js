!function(){"use strict";window.Type&&window.Type.registerNamespace?Type.registerNamespace("Office.Controls"):(void 0===window.Office&&(window.Office={},window.Office.namespace=!0),void 0===window.Office.Controls&&(window.Office.Controls={},window.Office.Controls.namespace=!0)),Office.Controls.PeopleAadDataProvider=function(){this.authContext=authContext},Office.Controls.PeopleAadDataProvider.prototype={maxResult:50,lastErrorMessage:null,severHost:"localhost:3000",acquireToken:"00000002-0000-0000-c000-000000000000",apiVersion:"api-version=1.5",getUsersAsync:function(e,t){var o=this;o.authContext.acquireToken(o.acquireToken,function(n,r){if(n||!r)return void t("Error",null);var i=o.authContext._extractIdToken(r),a="";i&&i.hasOwnProperty("tid")&&(a=i.tid);var s=new XMLHttpRequest;s.open("GET","https://graph.windows.net/"+a+"/users?"+apiVersion+"&$filter=startswith(displayName,"+encodeURIComponent("'"+e+"') or ")+"startswith(userPrincipalName,"+encodeURIComponent("'"+e+"')"),!0),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Authorization","Bearer "+r),s.onabort=s.onerror=s.ontimeout=function(){t("Error",null)},s.onload=function(){if(401===s.status)return void t("Unauthorized",null);if(200!==s.status)return void t("Unknown error",null);var e=JSON.parse(s.responseText),n=[];return void 0!==e["odata.error"]?void t(e["odata.error"],null):(e.value.forEach(function(e){var t={};t.displayName=e.displayName,t.department=e.department,t.jobTitle=e.jobTitle,t.mail=e.mail,t.workPhone=e.telephoneNumber,t.mobile=e.mobile,t.office=e.physicalDeliveryOfficeName,t.sipAddress=e.userPrincipalName,t.alias=e.mailNickname,t.personId=e.objectId,n.push(t)}),n.length>o.maxResult&&(n=n.slice(0,o.maxResult)),void t(null,n))},s.send("")})},getUserImageAsync:function(e,t){var o=this;o.authContext.acquireToken(o.acquireToken,function(n,r){if(n||!r)return void t("Error",null);var i=o.authContext._extractIdToken(r),a="";i&&i.hasOwnProperty("tid")&&(a=i.tid);var s=new XMLHttpRequest;s.open("GET","https://graph.windows.net/"+a+"/users/"+e+"/thumbnailPhoto?"+apiVersion),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Authorization","Bearer "+r),s.responseType="blob",s.onabort=s.onerror=s.ontimeout=function(){t("Error",null)},s.onload=function(){if(401===s.status)return void t("Unauthorized",null);if(200!==s.status)return void t("Unknown error",null);var e=new FileReader;e.addEventListener("loadend",function(){t(null,e.result)}),e.readAsDataURL(s.response)},s.send("")})}}}();