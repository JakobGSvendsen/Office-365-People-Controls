!function(){"use strict";window.Type&&window.Type.registerNamespace?Type.registerNamespace("Office.Controls"):(void 0===window.Office&&(window.Office={},window.Office.namespace=!0),void 0===window.Office.Controls&&(window.Office.Controls={},window.Office.Controls.namespace=!0)),Office.Controls.Persona=function(e,o,s,t){return"object"!=typeof e||"string"!=typeof o||"object"!=typeof s?void Office.Controls.Utils.errorConsole("Invalid parameters type"):(this.root=e,this.templateID=o.toString(),this.personaObject=s,this.isHidden=t,void this.loadDefaultTemplate(this.templateID))},Office.Controls.Persona.prototype={onError:null,rootNode:null,mainNode:null,actionNodes:null,actionDetailNodes:null,constantObject:{},oriID:"",get_rootNode:function(){return this.rootNode},get_mainNode:function(){return this.mainNode},get_actionNodes:function(){return this.actionNodes},get_actionDetailNodes:function(){return this.actionDetailNodes},loadDefaultTemplate:function(e){var o=Office.Controls.Persona.Templates.DefaultDefinition[e].value;return""===o||Office.Controls.Utils.isNullOrUndefined(o)?void alert("Fail to get the corret template content in loadDefaultTemplate"):void this.parseTemplate(o)},parseTemplate:function(e){try{var o=document.createElement("div");this.showNode(o,this.isHidden);var s=Office.Controls.Persona.PersonaHelper.getLocalCache(this.templateID);if(null===s&&(s=this.replaceConstantStrings(e),Office.Controls.Persona.PersonaHelper.setLocalCache(this.templateID,s)),o.innerHTML=this.bindPersonaData(s),Office.Controls.Utils.isNullOrUndefined(o))return void Office.Controls.Utils.errorConsole("Fail to get persona document");if(this.root.appendChild(o),this.rootNode=o,this.mainNode=o.getElementsByClassName(Office.Controls.PersonaConstants.SectionTag_Main),null===this.mainNode)this.mainNode=this.rootNode;else if(this.actionNodes=o.getElementsByClassName(Office.Controls.PersonaConstants.SectionTag_Action),null!==this.actionNodes){this.actionDetailNodes=o.getElementsByClassName(Office.Controls.PersonaConstants.SectionTag_ActionDetail);for(var t=null,n=this,r=0;r<n.actionNodes.length;r++)null!==n.actionNodes[r]&&(t=n.actionNodes[r],Office.Controls.Utils.addEventListener(t,"click",function(e){n.setActiveStyle(event)}))}}catch(i){throw i}},bindPersonaData:function(e){var o=/\$\{([^\}\{]+)\}/g;return this.bindData(e,o,this.personaObject)},replaceConstantStrings:function(e){this.initiateStringObject();var o=/\$\{Strings([^\}\{]+)\}/g;return this.bindData(e,o,this.constantObject)},bindData:function(e,o,s){if(""===e||Office.Controls.Utils.isNullOrUndefined(e)||""===o||Office.Controls.Utils.isNullOrUndefined(o)||"object"!=typeof s||Office.Controls.Utils.isNullOrUndefined(s))return Office.Controls.Utils.errorConsole("data object is null."),e;var t,n,r=e,i=this,a=r.match(o);if(null!==a)for(var l=0;l<a.length;l++)t=a[l].substring(2,a[l].length-1),n=i.getValueFromJSONObject(s,t),r=r.replace(a[l],n);return r},initiateStringObject:function(){var e=Office.Controls.Persona.Strings.Colon+Office.Controls.Persona.Strings.Space;this.constantObject.Strings={},this.constantObject.Strings.Label={},this.constantObject.Strings.Label.Email=Office.Controls.Persona.Strings.Label_Work+e,this.constantObject.Strings.Label.WorkPhone=Office.Controls.Persona.Strings.Label_Work+e,this.constantObject.Strings.Label.Mobile=Office.Controls.Persona.Strings.Label_Mobile+e,this.constantObject.Strings.Label.Skype=Office.Controls.Persona.Strings.Label_Skype+e,this.constantObject.Strings.Protocol={},this.constantObject.Strings.Protocol.Email=Office.Controls.Persona.Strings.Protocol_Mail,this.constantObject.Strings.Protocol.Phone=Office.Controls.Persona.Strings.Protocol_Phone,this.constantObject.Strings.Protocol.Skype=Office.Controls.Persona.Strings.Protocol_Skype},getValueFromJSONObject:function(e,o){var s=Office.Controls.Utils.getObjectFromJSONObjectName(e,o);return null===s?void Office.Controls.Utils.errorConsole("the json object is null for data binding."):s},showNode:function(e,o){o?(e.style.visibility="",e.style.display=""):(e.style.visibility="hidden",e.style.display="none")},removeDetailCard:function(){},setActiveStyle:function(e){for(var o=e||window.event,s=o.currentTarget,t="is-active",n=s.getAttribute("child"),r=0;r<this.actionNodes.length;r++)s===this.actionNodes[r]?this.oriID!==n?(Office.Controls.Utils.addClass(this.actionNodes[r],t),this.oriID=n):(this.oriID="",Office.Controls.Utils.removeClass(this.actionNodes[r],t)):Office.Controls.Utils.removeClass(this.actionNodes[r],t);for(var r=0;r<this.actionDetailNodes.length;r++)Office.Controls.Utils.containClass(this.actionDetailNodes[r],n)&&this.oriID===n?Office.Controls.Utils.addClass(this.actionDetailNodes[r],t):Office.Controls.Utils.removeClass(this.actionDetailNodes[r],t)}},Office.Controls.Persona.PersonaHelper=function(){},Office.Controls.Persona.PersonaHelper.createPersona=function(e,o,s){return new Office.Controls.Persona(e,s,o,!0)},Office.Controls.Persona.PersonaHelper.createInlinePersona=function(e,o,s){var t=null,n=[],r=Office.Controls.Persona.PersonaHelper.createPersona(e,o,Office.Controls.Persona.PersonaType.TypeEnum.NameImage);return"click"===s&&(null!==r.rootNode?(Office.Controls.Utils.addEventListener(r.rootNode,s,function(s){null==t?(t=Office.Controls.Persona.PersonaHelper.createPersonaCard(e,o),n.push(t)):(t.showNode(t.get_rootNode(),0==n.length),0!==n.length?n.pop(t):n.push(t))}),Office.Controls.Utils.addEventListener(document,s,function(){"html"===event.target.tagName.toLowerCase()&&0!==n.length&&(t.showNode(t.get_rootNode(),!1),n.pop(t))})):Office.Controls.Utils.errorConsole("Wrong template path")),r},Office.Controls.Persona.PersonaHelper.createPersonaCard=function(e,o){return Office.Controls.Persona.PersonaHelper.createPersona(e,o,Office.Controls.Persona.PersonaType.TypeEnum.PersonaCard)},Office.Controls.Persona.PersonaHelper.convertAadUserToPersonaObject=function(e){if("object"!=typeof e||Office.Controls.Utils.isNullOrUndefined(e))return void Office.Controls.Utils.errorConsole("AAD user data is null.");var o=Office.Controls.Persona.StringUtils.getDisplayText(e.displayName,Office.Controls.Persona.PersonaType.TypeEnum.NameImage,3),s={};return s.Id=e.personId,s.ImageUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAMAAADVRocKAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAORQTFRFsbGxv7+/wcHBu7u72dnZ7u7u/////Pz85ubmy8vLtbW1wsLC5OTk/f3939/ft7e34eHh+vr61NTUs7OzwMDA8/Pz7OzsxMTE9PT0vLy8+/v7+fn5urq6vb298fHxtLS0srKyzc3N9/f32NjYtra209PT7e3t7+/v/v7+yMjI3t7e4+Pj6+vr6urq4uLi19fXx8fH0tLS9fX1ubm59vb2z8/PuLi4+Pj429vbzs7O0NDQ4ODg1dXV2tra1tbWzMzMxcXF6enp0dHR8vLyysrKxsbG3d3d6Ojovr6+5eXl5+fn8PDwYCkYCwAAAAFiS0dEBmFmuH0AAAAJcEhZcwAAdTAAAHUwAd0zcs0AAAKgSURBVGje7ZjdVtpQEIUByxCIIRKtYECgSSVULbWopRDBarVq+/7vU1raBcTMmbEzueha7Ous/XEOZ35zuY022mij/0z5QqGQmfnWqyL8VskqV/Tt7W1YkVN1de0rO5BQzdtV9N97Dc+1r3eIegnS1DhQ8rd9SFezpeJ/2ARM7Y6Cf7cIuCwFgAcmvRH7t3wjIBCHXBXMCoX+rkMA/LcywBFQOpIBeiQgkt1QnwSAKNre0f6ylxoyAMcSwAkDsC8BnDIAgQQQMQCOBNBmAECSUotZA95zAJIrGjD8mxLABwagKAGcMQADCYCTiz5KAIxsCnkRwCP9hyJ/uqKJayb1UJ1zIeDc3FXAjtCfCoWa9ADzzv3CBLgU+8/HphLuf6rgn8uVUf/GJxUA2hwFOu37rzOk3tJQawCZy075p7eFTeO6OmHiECN5455Q63OwtG+PdWbM+qQaXx0uL2oa96IoGsxWE+h1bB1P7H9x3wpHi59bNQwZ7p+q3fZeOtR+Wan3DXQ/YS+vzYlf8mjd9Z7RuUr9ajdcS+ZOzE5Ml7Xkm7xJidn8s7bMP2PZd+OUqGom01onTKlF/VsOAJn7vpZXnmZrFqR/dUf7j9Hc5lu39UIlfz+Jh/g3ZA/g4psDlhrU5EwNxqSILuCA0WqZRUzOU6k/gPEldUdyQM8E4HS7lPqmtMSZW0mZSsWNBsA0OQdye+P6oqLhDz4O2FMBAJ6273QAdRRAzxssTVDANx3AFAVYOgB88OQsPxh6QAHCWvBX6GyuEwbzooMBHpUAaKTdKwEA61zHcuuFsMlnpgV4zDbO8FzxpAXA2i/Wio4jbHy+kFsv5CEAcrXCFdJ8uVr+WFXOqwFOMg5k+J5xIGMbebVAhh8ZBzK2KVQLZKituP4EqRB824c6sq4AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTQtMTAtMjlUMjA6MjQ6MTktMDU6MDBCpOLkAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE0LTEwLTI5VDIwOjI0OjE5LTA1OjAwM/laWAAAAABJRU5ErkJggg==",s.PrimaryText=""===o?Office.Controls.Persona.Strings.EmptyDisplayName:o,s.SecondaryText=null!==e.jobTitle?e.jobTitle+Office.Controls.Persona.Strings.Comma+e.department:e.department,s.SecondaryTextShort=Office.Controls.Persona.StringUtils.getDisplayText(s.SecondaryText,Office.Controls.Persona.PersonaType.TypeEnum.PersonaCard,0),s.TertiaryText=Office.Controls.Persona.StringUtils.getDisplayText(e.office,Office.Controls.Persona.PersonaType.TypeEnum.PersonaCard,0),s.Actions={},s.Actions.Email=e.mail,s.Actions.WorkPhone=e.workPhone,s.Actions.Mobile=e.mobile,s.Actions.Skype=e.sipAddress,s},Office.Controls.Persona.PersonaHelper.convertAadUsersToPersonaObjects=function(e){if("object"!=typeof e||Office.Controls.Utils.isNullOrUndefined(e))return void Office.Controls.Utils.errorConsole("AAD user collection is null.");var o=[];return e.forEach(function(e){o.push(Office.Controls.Persona.PersonaHelper.convertAadUserToPersonaObject(e))}),o},Office.Controls.Persona.PersonaHelper.getLocalCache=function(e){if(""===e||Office.Controls.Utils.isNullOrUndefined(e))return void Office.Controls.Utils.errorConsole("Wrong Cache ID");var o=e.toLowerCase(),s=Office.Controls.Persona.PersonaHelper._localCache[o];return Office.Controls.Utils.isNullOrUndefined(s)?null:s},Office.Controls.Persona.PersonaHelper.setLocalCache=function(e,o){if(""===e||Office.Controls.Utils.isNullOrUndefined(e))return void Office.Controls.Utils.errorConsole("Wrong Cache ID");if("object"!=typeof o&&"string"!=typeof o||Office.Controls.Utils.isNullOrUndefined(o))return void Office.Controls.Utils.errorConsole("Invalid Cached Object");var s=e.toLowerCase();Office.Controls.Persona.PersonaHelper._localCache[s]=o},Office.Controls.Persona.PersonaType=function(){},Office.Controls.Persona.PersonaType.TypeEnum={NameOnly:"nameonly",NameImage:"nameimage",DetailCard:"detailcard",PersonaCard:"personacard"},Office.Controls.Persona.ImageSize=function(){},Office.Controls.Persona.ImageSize.TypeEnum={s:0,m:1,l:2},Office.Controls.Persona.StringUtils=function(){},Office.Controls.Persona.StringUtils.getDisplayText=function(e,o,s){return e?(Office.Controls.Persona.StringUtils._propertyDisplayConfiguration&&Office.Controls.Persona.StringUtils._currentPersonaType===o||(Office.Controls.Persona.StringUtils._propertyDisplayConfiguration=Office.Controls.Persona.StringUtils._loadLengthConfiguration(o),Office.Controls.Persona.StringUtils._currentPersonaType=o),Office.Controls.Persona.StringUtils._propertyDisplayConfiguration.length&&e.length>Office.Controls.Persona.StringUtils._propertyDisplayConfiguration[s]?e.substr(0,Office.Controls.Persona.StringUtils._propertyDisplayConfiguration[s])+"...":e):""},Office.Controls.Persona.StringUtils._loadLengthConfiguration=function(e){var o;switch(e){case Office.Controls.Persona.PersonaType.TypeEnum.NameImage:o=Office.Controls.Persona.StringUtils._propertyDisplayConfiguration=[18,26,40,42];break;case Office.Controls.Persona.PersonaType.TypeEnum.NameOnly:case Office.Controls.Persona.PersonaType.TypeEnum.DetailCard:case Office.Controls.Persona.PersonaType.TypeEnum.PersonaCard:o=Office.Controls.Persona.StringUtils._propertyDisplayConfiguration=Office.Controls.Utils.isIE()||Office.Controls.Utils.isFirefox()?[30,0,40,42]:[30,0,40,42];break;default:o=null}return o},Office.Controls.Persona.Strings=function(){},Office.Controls.Persona.Templates=function(){},Office.Controls.PersonaResources=function(){},Office.Controls.PersonaConstants=function(){},Office.Controls.Persona.registerClass&&Office.Controls.Persona.registerClass("Office.Controls.Persona"),Office.Controls.Persona.Strings.registerClass&&Office.Controls.Persona.Strings.registerClass("Office.Controls.Persona.Strings"),Office.Controls.PersonaConstants.registerClass&&Office.Controls.PersonaConstants.registerClass("Office.Controls.PersonaConstants"),Office.Controls.PersonaResources.registerClass&&Office.Controls.PersonaResources.registerClass("Office.Controls.PersonaResources"),Office.Controls.Persona.PersonaHelper.registerClass&&Office.Controls.Persona.PersonaHelper.registerClass("Office.Controls.Persona.PersonaHelper"),Office.Controls.Persona.StringUtils.registerClass&&Office.Controls.Persona.StringUtils.registerClass("Office.Controls.Persona.StringUtils"),Office.Controls.PersonaResources.PersonaName="Persona",Office.Controls.Persona.Strings.Label_Skype="Skype",Office.Controls.Persona.Strings.Label_Work="Work",Office.Controls.Persona.Strings.Label_Mobile="Mobile",Office.Controls.Persona.Strings.Protocol_Mail="mailto:",Office.Controls.Persona.Strings.Protocol_Phone="tel:",Office.Controls.Persona.Strings.Protocol_Skype="sip:",Office.Controls.Persona.Strings.Colon=":",Office.Controls.Persona.Strings.Comma=",",Office.Controls.Persona.Strings.Space=" ",Office.Controls.Persona.Strings.SuspensionPoints="...",Office.Controls.Persona.Strings.EmptyDisplayName="No Name",Office.Controls.Persona.StringUtils._propertyDisplayConfiguration=null,Office.Controls.Persona.StringUtils._currentPersonaType=0,Office.Controls.Persona.PersonaHelper._localCache={},Office.Controls.PersonaConstants.SectionTag_Main="persona-section-tag-main",Office.Controls.PersonaConstants.SectionTag_Action="ms-PersonaCard-action",Office.Controls.PersonaConstants.SectionTag_ActionDetail="ms-PersonaCard-actionDetails",Office.Controls.Persona.Templates.DefaultDefinition={nameonly:{value:'<div class="ms-Persona ms-Persona--tiny readOnly clickStyle" AriaTabIndex="0"><div class="ms-Persona-primaryText nameOnlyText"><Label Text="${PrimaryText}">${PrimaryText}</Label></div></div>'},nameimage:{value:'<div class="ms-Persona"><image class="imageOfNameImage image" ImageName="${PrimaryText}" Src="${ImageUrl}"></image><div class="ms-Persona-details ms-Persona-details-nameImage"><div class="ms-Persona-primaryText ms-Persona-primaryText-nameImage"><Label class="clickStyle" Text="${PrimaryText}" Title="${PrimaryText}">${PrimaryText}</Label></div><div class="ms-Persona-secondaryText ms-Persona-secondaryText-nameImage"><Label class="defaultStyle" Text="${SecondaryText}" Title="${SecondaryText}">${SecondaryText}</Label></div></div></div>'},detailcard:{value:'<div class="ms-PersonaCard personaCard-customized detail displayMode"><div class="ms-PersonaCard-persona"><div class="ms-Persona ms-Persona--xl"><image class="ms-Persona-image image" ImageName="${PrimaryText}" Src="${ImageUrl}"></image><div class="ms-Persona-details"><div class="ms-Persona-primaryText"><Label class="defaultStyle" Text="${PrimaryText}">${PrimaryText}</Label></div><div class="ms-Persona-secondaryText"><Label class="defaultStyle" Text="${SecondaryText}">${SecondaryText}</Label></div><div class="ms-Persona-tertiaryText"><Label class="defaultStyle" Text="${TertiaryText}">${TertiaryText}</Label></div></div></div></div></div>'},personacard:{value:'<div class="ms-PersonaCard personaCard-customized detail displayMode"><div class="ms-PersonaCard-persona persona-section-tag-main"><div class="ms-Persona ms-Persona--xl"><image class="ms-Persona-image image" ImageName="${PrimaryText}" Src="${ImageUrl}"></image><div class="ms-Persona-details"><div class="ms-Persona-primaryText"><Label class="defaultStyle" Text="${PrimaryText}">${PrimaryText}</Label></div><div class="ms-Persona-secondaryText"><Label class="defaultStyle" title="${SecondaryText}">${SecondaryTextShort}</Label></div><div class="ms-Persona-tertiaryText"><Label class="defaultStyle" Text="${TertiaryText}">${TertiaryText}</Label></div></div></div></div><ul class="ms-PersonaCard-actions"><li class="ms-PersonaCard-action" child="action-detail-mail"><i class="ms-Icon ms-Icon--mail icon"><span></span></i></li><li class="ms-PersonaCard-action" child="action-detail-phone"><i class="ms-Icon ms-Icon--phone icon"><span></span></i></li><li class="ms-PersonaCard-action" child="action-detail-chat"><i class="ms-Icon ms-Icon--chat icon"><span></span></i></li></ul><div class="ms-PersonaCard-actionDetails action-detail-mail"><div class="ms-PersonaCard-detailLine"><span class="ms-PersonaCard-detailLabel">${Strings.Label.Email}</span><a href="${Strings.Protocol.Email}${Actions.Email}">${Actions.Email}</a></div></div><div class="ms-PersonaCard-actionDetails action-detail-phone"><div class="ms-PersonaCard-detailLine"><span class="ms-PersonaCard-detailLabel">${Strings.Label.WorkPhone}</span><a href="${Strings.Protocol.Phone}${Actions.WorkPhone}">${Actions.WorkPhone}</a><br/><span class="ms-PersonaCard-detailLabel">${Strings.Label.Mobile}</span><a href="${Strings.Protocol.Phone}${Actions.Mobile}">${Actions.Mobile}</a></div></div><div class="ms-PersonaCard-actionDetails action-detail-chat"><div class="ms-PersonaCard-detailLine"><span class="ms-PersonaCard-detailLabel">${Strings.Label.Skype}</span><a href="${Strings.Protocol.Skype}${Actions.Skype}">${Actions.Skype}</a></div></div></div>'}}}();