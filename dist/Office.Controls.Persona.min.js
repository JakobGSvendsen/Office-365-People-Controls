!function(){"use strict";window.Type&&window.Type.registerNamespace?Type.registerNamespace("Office.Controls"):(void 0===window.Office&&(window.Office={},window.Office.namespace=!0),void 0===window.Office.Controls&&(window.Office.Controls={},window.Office.Controls.namespace=!0)),Office.Controls.Persona=function(e,o,n,t){return"object"!=typeof e||"object"!=typeof n||Office.Controls.Utils.isNullOrUndefined(o)?void Office.Controls.Utils.errorConsole("Invalid parameters type"):(this.root=e,this.templateID=o,this.dataProvider=n,void(this.isHidden=t))},Office.Controls.Persona.prototype={onError:null,rootNode:null,mainNode:null,actionNodes:null,actionDetailNodes:null,oriID:"",get_rootNode:function(){return this.rootNode},get_mainNode:function(){return this.mainNode},get_actionNodes:function(){return this.actionNodes},get_actionDetailNodes:function(){return this.actionDetailNodes},loadTemplateAsync:function(e,o){var n=this,t=Office.Controls.Persona.PersonaHelper.getCachedTemplate(e);if(null!==t)return n.parseTemplate(t),void o(n.rootNode,null);var s=new XMLHttpRequest;s.open("GET",e,!0),s.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var t,s;window.DOMParser?(t=new DOMParser,s=t.parseFromString(this.responseText,"text/xml")):(s=new ActiveXObject("Microsoft.XMLDOM"),s.async=!1,s.loadXML(this.responseText)),Office.Controls.Persona.PersonaHelper.setCachedTemplate(e,s),n.parseTemplate(s),o(n.rootNode,null)}},s.send()},parseTemplate:function(e){try{var o=e.getElementById(this.templateID),n=document.createElement("div");if(this.hiddenNode(n,this.isHidden),n.innerHTML=this.bindData(o.innerHTML),Office.Controls.Utils.isNullOrUndefined(n))return void Office.Controls.Utils.errorConsole("Fail to get persona document");if(this.root.appendChild(n),this.rootNode=n,this.mainNode=n.getElementsByClassName(Office.Controls.PersonaConstants.SectionTag_Main),null===this.mainNode)this.mainNode=this.rootNode;else if(this.actionNodes=n.getElementsByClassName(Office.Controls.PersonaConstants.SectionTag_Action),null!==this.actionNodes){this.actionDetailNodes=n.getElementsByClassName(Office.Controls.PersonaConstants.SectionTag_ActionDetail);for(var t=null,s=this,r=0;r<s.actionNodes.length;r++)null!==s.actionNodes[r]&&(t=s.actionNodes[r],Office.Controls.Utils.addEventListener(t,"click",function(e){s.setActiveStyle(event)}))}}catch(i){throw i}},bindData:function(e){for(var o,n,t=/\$\{([^\}\{]+)\}/g,s=e,r=s.match(t),i=this,a=0;a<r.length;a++)o=r[a].substring(2,r[a].length-1),n=i.getValueFromJSONObject(o),s=s.replace(r[a],n);return s},getValueFromJSONObject:function(e){return Office.Controls.Utils.getObjectFromJSONObjectName(this.dataProvider,e)},hiddenNode:function(e,o){o?(e.style.visibility="",e.style.display=""):(e.style.visibility="hidden",e.style.display="none")},removeDetailCard:function(){},setActiveStyle:function(e){for(var o=e||window.event,n=o.currentTarget,t="is-active",s=n.getAttribute("child"),r=0;r<this.actionNodes.length;r++)n===this.actionNodes[r]?this.oriID!==s?(Office.Controls.Utils.addClass(this.actionNodes[r],t),this.oriID=s):(this.oriID="",Office.Controls.Utils.removeClass(this.actionNodes[r],t)):Office.Controls.Utils.removeClass(this.actionNodes[r],t);for(var r=0;r<this.actionDetailNodes.length;r++)Office.Controls.Utils.containClass(this.actionDetailNodes[r],s)&&this.oriID===s?Office.Controls.Utils.addClass(this.actionDetailNodes[r],t):Office.Controls.Utils.removeClass(this.actionDetailNodes[r],t)}},Office.Controls.Persona.PersonaHelper=function(){},Office.Controls.Persona.PersonaHelper.createPersona=function(e,o,n,t,s,r){var i=new Office.Controls.Persona(e,n,t,s);i.loadTemplateAsync(o,r)},Office.Controls.Persona.PersonaHelper.createInlinePersona=function(e,o,n,t){var s=null,r=!0,i=new Office.Controls.Persona(e,Office.Controls.Persona.PersonaHelper.getPersonaType().NameImage,n,!0);return i.loadTemplateAsync(o,function(o,i){"click"===t&&(null!==o?Office.Controls.Utils.addEventListener(o,t,function(o){null==s?(s=new Office.Controls.Persona(e,Office.Controls.Persona.PersonaHelper.getPersonaType().PersonaCard,n,!0),s.loadTemplateAsync(tempPath,function(e,o){r=!1})):(s.hiddenNode(s.get_rootNode(),r),r=r?!1:!0)}):Office.Controls.Utils.errorConsole("Wrong template path"))}),i},Office.Controls.Persona.PersonaHelper.createPersonaCard=function(e,o,n,t){return Office.Controls.Persona.PersonaHelper.createPersona(e,o,Office.Controls.Persona.PersonaHelper.getPersonaType().PersonaCard,n,!0,t)},Office.Controls.Persona.PersonaHelper.getCachedTemplate=function(e){if(""===e||Office.Controls.Utils.isNullOrUndefined(e))return void Office.Controls.Utils.errorConsole("Wrong template path");var o=e.toLowerCase(),n=Office.Controls.Persona.PersonaHelper._cachedTemplates[o];return Office.Controls.Utils.isNullOrUndefined(n)?null:n},Office.Controls.Persona.PersonaHelper.setCachedTemplate=function(e,o){if(""===e||Office.Controls.Utils.isNullOrUndefined(e))return void Office.Controls.Utils.errorConsole("Wrong template path");if("object"!=typeof o||Office.Controls.Utils.isNullOrUndefined(o))return void Office.Controls.Utils.errorConsole("Invalid template document");var n=e.toLowerCase();Office.Controls.Persona.PersonaHelper._cachedTemplates[n]=o},Office.Controls.Persona.PersonaHelper.getPersonaType=function(){var e={NameOnly:"nameonly",NameImage:"nameimage",DetailCard:"detailcard",PersonaCard:"personacard"};return e},Office.Controls.Persona.ImageSize=function(){},Office.Controls.Persona.ImageSize.prototype={s:0,m:1,l:2},Office.Controls.Persona.StringUtils=function(){},Office.Controls.Persona.StringUtils.getDisplayText=function(e,o,n){return e?(Office.Controls.Persona.StringUtils._propertyDisplayConfiguration&&Office.Controls.Persona.StringUtils._currentPersonaType===o||(Office.Controls.Persona.StringUtils._propertyDisplayConfiguration=Office.Controls.Persona.StringUtils._loadLengthConfiguration(o),Office.Controls.Persona.StringUtils._currentPersonaType=o),Office.Controls.Persona.StringUtils._propertyDisplayConfiguration.length&&e.length>Office.Controls.Persona.StringUtils._propertyDisplayConfiguration[n]?e.substr(0,Office.Controls.Persona.StringUtils._propertyDisplayConfiguration[n])+"...":e):""},Office.Controls.Persona.StringUtils._loadLengthConfiguration=function(e){var o;switch(e){case 1:o=Office.Controls.Persona.StringUtils._propertyDisplayConfiguration=[18,26,40,42];break;case 0:case 4:o=Office.Controls.Persona.StringUtils._propertyDisplayConfiguration=Office.Controls.Utils.isIE()||Office.Controls.Utils.isFirefox()?[30,0,40,42]:[27,0,40,42];break;default:o=null}return o},Office.Controls.Persona.Strings=function(){},Office.Controls.PersonaResources=function(){},Office.Controls.PersonaConstants=function(){},Office.Controls.Persona.registerClass&&Office.Controls.Persona.registerClass("Office.Controls.Persona"),Office.Controls.Persona.Strings.registerClass&&Office.Controls.Persona.Strings.registerClass("Office.Controls.Persona.Strings"),Office.Controls.PersonaConstants.registerClass&&Office.Controls.PersonaConstants.registerClass("Office.Controls.PersonaConstants"),Office.Controls.PersonaResources.registerClass&&Office.Controls.PersonaResources.registerClass("Office.Controls.PersonaResources"),Office.Controls.Persona.PersonaHelper.registerClass&&Office.Controls.Persona.PersonaHelper.registerClass("Office.Controls.Persona.PersonaHelper"),Office.Controls.Persona.StringUtils.registerClass&&Office.Controls.Persona.StringUtils.registerClass("Office.Controls.Persona.StringUtils"),Office.Controls.PersonaResources.PersonaName="Persona",Office.Controls.Persona.Strings.emailString="Email",Office.Controls.Persona.Strings.lyncMessageString="IM",Office.Controls.Persona.Strings.phoneString="Phone",Office.Controls.Persona.Strings.mobileString="Mobile",Office.Controls.Persona.Strings.workPhoneString="Work",Office.Controls.Persona.Strings.colonString=":",Office.Controls.Persona.Strings.suspensionPoints="...",Office.Controls.Persona.StringUtils._propertyDisplayConfiguration=null,Office.Controls.Persona.StringUtils._currentPersonaType=0,Office.Controls.Persona.PersonaHelper._cachedTemplates={},Office.Controls.PersonaConstants.SectionTag_Main="persona-section-tag-main",Office.Controls.PersonaConstants.SectionTag_Action="ms-PersonaCard-action",Office.Controls.PersonaConstants.SectionTag_ActionDetail="ms-PersonaCard-actionDetails"}();