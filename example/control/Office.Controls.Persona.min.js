!function(){"use strict";window.Type&&window.Type.registerNamespace?Type.registerNamespace("Office.Controls"):(void 0===window.Office&&(window.Office={},window.Office.namespace=!0),void 0===window.Office.Controls&&(window.Office.Controls={},window.Office.Controls.namespace=!0)),Office.Controls.Persona=function(e,o,t,n){return"object"!=typeof e||"object"!=typeof t||Office.Controls.Utils.isNullOrUndefined(o)?void Office.Controls.Utils.errorConsole("Invalid parameters type"):(this.root=e,this.templateID=o,this.dataProvider=t,void(this.isHidden=n))},Office.Controls.Persona.prototype={onError:null,rootNode:null,mainNode:null,actionNodes:null,actionDetailNodes:null,oriID:"",get_rootNode:function(){return this.rootNode},get_mainNode:function(){return this.mainNode},get_actionNodes:function(){return this.actionNodes},get_actionDetailNodes:function(){return this.actionDetailNodes},loadTemplateAsync:function(e,o){var t=this,n=Office.Controls.Persona.PersonaHelper.getCachedTemplate(e);if(null!==n)return t.parseTemplate(n),void o(t.rootNode,null);var s=new XMLHttpRequest;s.open("GET",e,!0),s.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var n,s;window.DOMParser?(n=new DOMParser,s=n.parseFromString(this.responseText,"text/xml")):(s=new ActiveXObject("Microsoft.XMLDOM"),s.async=!1,s.loadXML(this.responseText)),Office.Controls.Persona.PersonaHelper.setCachedTemplate(e,s),t.parseTemplate(s),o(t.rootNode,null)}},s.send()},parseTemplate:function(e){try{var o=e.getElementById(this.templateID),t=document.createElement("div");if(this.hiddenNode(t,this.isHidden),t.innerHTML=this.bindData(o.innerHTML),Office.Controls.Utils.isNullOrUndefined(t))return void Office.Controls.Utils.errorConsole("Fail to get persona document");if(this.root.appendChild(t),this.rootNode=t,this.mainNode=t.getElementsByClassName(Office.Controls.PersonaConstants.SectionTag_Main),null===this.mainNode)this.mainNode=this.rootNode;else if(this.actionNodes=t.getElementsByClassName(Office.Controls.PersonaConstants.SectionTag_Action),null!==this.actionNodes){this.actionDetailNodes=t.getElementsByClassName(Office.Controls.PersonaConstants.SectionTag_ActionDetail);for(var n=null,s=this,r=0;r<s.actionNodes.length;r++)null!==s.actionNodes[r]&&(n=s.actionNodes[r],Office.Controls.Utils.addEventListener(n,"click",function(e){s.setActiveStyle(event)}))}}catch(i){throw i}},bindData:function(e){for(var o,t,n=/\$\{([^\}\{]+)\}/g,s=e,r=s.match(n),i=this,a=0;a<r.length;a++)o=r[a].substring(2,r[a].length-1),t=i.getValueFromJSONObject(o),s=s.replace(r[a],t);return s},getValueFromJSONObject:function(e){return Office.Controls.Utils.getObjectFromJSONObjectName(this.dataProvider,e)},hiddenNode:function(e,o){o?(e.style.visibility="",e.style.display=""):(e.style.visibility="hidden",e.style.display="none")},removeDetailCard:function(){},setActiveStyle:function(e){for(var o=e||window.event,t=o.currentTarget,n="is-active",s=t.getAttribute("child"),r=0;r<this.actionNodes.length;r++)t===this.actionNodes[r]?this.oriID!==s?(Office.Controls.Utils.addClass(this.actionNodes[r],n),this.oriID=s):(this.oriID="",Office.Controls.Utils.removeClass(this.actionNodes[r],n)):Office.Controls.Utils.removeClass(this.actionNodes[r],n);for(var r=0;r<this.actionDetailNodes.length;r++)Office.Controls.Utils.containClass(this.actionDetailNodes[r],s)&&this.oriID===s?Office.Controls.Utils.addClass(this.actionDetailNodes[r],n):Office.Controls.Utils.removeClass(this.actionDetailNodes[r],n)}},Office.Controls.Persona.PersonaHelper=function(){},Office.Controls.Persona.PersonaHelper.createPersona=function(e,o,t,n,s,r){var i=new Office.Controls.Persona(e,t,n,s);i.loadTemplateAsync(o,r)},Office.Controls.Persona.PersonaHelper.getCachedTemplate=function(e){if(""===e||Office.Controls.Utils.isNullOrUndefined(e))return void Office.Controls.Utils.errorConsole("Wrong template path");var o=e.toLowerCase(),t=Office.Controls.Persona.PersonaHelper._cachedTemplates[o];return Office.Controls.Utils.isNullOrUndefined(t)?null:t},Office.Controls.Persona.PersonaHelper.setCachedTemplate=function(e,o){if(""===e||Office.Controls.Utils.isNullOrUndefined(e))return void Office.Controls.Utils.errorConsole("Wrong template path");if("object"!=typeof o||Office.Controls.Utils.isNullOrUndefined(o))return void Office.Controls.Utils.errorConsole("Invalid template document");var t=e.toLowerCase();Office.Controls.Persona.PersonaHelper._cachedTemplates[t]=o},Office.Controls.Persona.PersonaHelper.getPersonaType=function(){var e={NameOnly:"nameonly",NameImage:"nameimage",DetailCard:"detailcard",PersonaCard:"personacard"};return e},Office.Controls.Persona.ImageSize=function(){},Office.Controls.Persona.ImageSize.prototype={s:0,m:1,l:2},Office.Controls.Persona.StringUtils=function(){},Office.Controls.Persona.StringUtils.getDisplayText=function(e,o,t){return e?(Office.Controls.Persona.StringUtils._propertyDisplayConfiguration&&Office.Controls.Persona.StringUtils._currentPersonaType===o||(Office.Controls.Persona.StringUtils._propertyDisplayConfiguration=Office.Controls.Persona.StringUtils._loadLengthConfiguration(o),Office.Controls.Persona.StringUtils._currentPersonaType=o),Office.Controls.Persona.StringUtils._propertyDisplayConfiguration.length&&e.length>Office.Controls.Persona.StringUtils._propertyDisplayConfiguration[t]?e.substr(0,Office.Controls.Persona.StringUtils._propertyDisplayConfiguration[t])+"...":e):""},Office.Controls.Persona.StringUtils._loadLengthConfiguration=function(e){var o;switch(e){case 1:o=Office.Controls.Persona.StringUtils._propertyDisplayConfiguration=[18,26,40,42];break;case 0:case 4:o=Office.Controls.Persona.StringUtils._propertyDisplayConfiguration=Office.Controls.Utils.isIE()||Office.Controls.Utils.isFirefox()?[30,0,40,42]:[27,0,40,42];break;default:o=null}return o},Office.Controls.Persona.Strings=function(){},Office.Controls.PersonaResources=function(){},Office.Controls.PersonaConstants=function(){},Office.Controls.Persona.registerClass&&Office.Controls.Persona.registerClass("Office.Controls.Persona"),Office.Controls.Persona.Strings.registerClass&&Office.Controls.Persona.Strings.registerClass("Office.Controls.Persona.Strings"),Office.Controls.PersonaConstants.registerClass&&Office.Controls.PersonaConstants.registerClass("Office.Controls.PersonaConstants"),Office.Controls.PersonaResources.registerClass&&Office.Controls.PersonaResources.registerClass("Office.Controls.PersonaResources"),Office.Controls.Persona.PersonaHelper.registerClass&&Office.Controls.Persona.PersonaHelper.registerClass("Office.Controls.Persona.PersonaHelper"),Office.Controls.Persona.StringUtils.registerClass&&Office.Controls.Persona.StringUtils.registerClass("Office.Controls.Persona.StringUtils"),Office.Controls.PersonaResources.PersonaName="Persona",Office.Controls.Persona.Strings.emailString="Email",Office.Controls.Persona.Strings.lyncMessageString="IM",Office.Controls.Persona.Strings.phoneString="Phone",Office.Controls.Persona.Strings.mobileString="Mobile",Office.Controls.Persona.Strings.workPhoneString="Work",Office.Controls.Persona.Strings.colonString=":",Office.Controls.Persona.Strings.suspensionPoints="...",Office.Controls.Persona.StringUtils._propertyDisplayConfiguration=null,Office.Controls.Persona.StringUtils._currentPersonaType=0,Office.Controls.Persona.PersonaHelper._cachedTemplates={},Office.Controls.PersonaConstants.SectionTag_Main="persona-section-tag-main",Office.Controls.PersonaConstants.SectionTag_Action="ms-PersonaCard-action",Office.Controls.PersonaConstants.SectionTag_ActionDetail="ms-PersonaCard-actionDetails"}();