!function(){"use strict";window.Type&&window.Type.registerNamespace?Type.registerNamespace("Office.Controls"):(void 0===window.Office&&(window.Office={},window.Office.namespace=!0),void 0===window.Office.Controls&&(window.Office.Controls={},window.Office.Controls.namespace=!0)),Office.Controls.Persona=function(e,o,t,s){return"object"!=typeof e||"object"!=typeof t||Office.Controls.Utils.isNullOrUndefined(o)?void Office.Controls.Utils.errorConsole("Invalid parameters type"):(this.root=e,this.templateID=o,this.dataProvider=t,void(this.isHidden=s))},Office.Controls.Persona.prototype={onError:null,rootNode:null,mainNode:null,actionNodes:null,actionDetailNodes:null,oriID:"",get_rootNode:function(){return this.rootNode},get_mainNode:function(){return this.mainNode},get_actionNodes:function(){return this.actionNodes},get_actionDetailNodes:function(){return this.actionDetailNodes},loadTemplateAsync:function(e,o){if(Office.Controls.Utils.isNullOrUndefined(e))return void Office.Controls.Utils.errorConsole("Wrong template path");var t=this,s=new XMLHttpRequest;s.open("GET",e,!0),s.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var e,s;window.DOMParser?(e=new DOMParser,s=e.parseFromString(this.responseText,"text/xml")):(s=new ActiveXObject("Microsoft.XMLDOM"),s.async=!1,s.loadXML(this.responseText)),t.parseTemplate(s),o(t.rootNode,null)}},s.send()},parseTemplate:function(e){try{if("object"!=typeof e||Office.Controls.Utils.isNullOrUndefined(e))return void Office.Controls.Utils.errorConsole("Invalid template document");var o=e.getElementById(this.templateID),t=document.createElement("div");if(this.hiddenNode(t,this.isHidden),t.innerHTML=this.bindData(o.innerHTML),Office.Controls.Utils.isNullOrUndefined(t))return void Office.Controls.Utils.errorConsole("Fail to get persona document");if(this.root.appendChild(t),this.rootNode=t,this.mainNode=t.getElementsByClassName(Office.Controls.PersonaConstants.SectionTag_Main),null===this.mainNode)this.mainNode=this.rootNode;else if(this.actionNodes=t.getElementsByClassName(Office.Controls.PersonaConstants.SectionTag_Action),null!==this.actionNodes){this.actionDetailNodes=t.getElementsByClassName(Office.Controls.PersonaConstants.SectionTag_ActionDetail);for(var s=null,n=this,i=0;i<n.actionNodes.length;i++)null!==n.actionNodes[i]&&(s=n.actionNodes[i],Office.Controls.Utils.addEventListener(s,"click",function(e){n.setActiveStyle(event)}))}}catch(r){throw r}},bindData:function(e){for(var o=/\$\{([^\}\{]+)\}/g,t=e,s=this.dataProvider,n=t.match(o),i=0;i<n.length;i++){var r=s[n[i].substring(2,n[i].length-1)];t=t.replace(n[i],r)}return t},hiddenNode:function(e,o){o?(e.style.visibility="",e.style.display=""):(e.style.visibility="hidden",e.style.display="none")},removeDetailCard:function(){},setActiveStyle:function(e){for(var o=e||window.event,t=o.currentTarget,s="is-active",n=t.getAttribute("child"),i=0;i<this.actionNodes.length;i++)t===this.actionNodes[i]?this.oriID!==n?(Office.Controls.Utils.addClass(this.actionNodes[i],s),this.oriID=n):(this.oriID="",Office.Controls.Utils.removeClass(this.actionNodes[i],s)):Office.Controls.Utils.removeClass(this.actionNodes[i],s);for(var i=0;i<this.actionDetailNodes.length;i++)Office.Controls.Utils.containClass(this.actionDetailNodes[i],n)&&this.oriID===n?Office.Controls.Utils.addClass(this.actionDetailNodes[i],s):Office.Controls.Utils.removeClass(this.actionDetailNodes[i],s)}},Office.Controls.Persona.Strings=function(){},Office.Controls.PersonaResources=function(){},Office.Controls.PersonaConstants=function(){},Office.Controls.Persona.registerClass&&Office.Controls.Persona.registerClass("Office.Controls.Persona"),Office.Controls.Persona.Strings.registerClass&&Office.Controls.Persona.Strings.registerClass("Office.Controls.Persona.Strings"),Office.Controls.PersonaConstants.registerClass&&Office.Controls.PersonaConstants.registerClass("Office.Controls.PersonaConstants"),Office.Controls.PersonaResources.registerClass&&Office.Controls.PersonaResources.registerClass("Office.Controls.PersonaResources"),Office.Controls.PersonaResources.PersonaName="Persona",Office.Controls.Persona.Strings.emailString="Email",Office.Controls.Persona.Strings.lyncMessageString="IM",Office.Controls.Persona.Strings.phoneString="Phone",Office.Controls.Persona.Strings.mobileString="Mobile",Office.Controls.Persona.Strings.workPhoneString="Work",Office.Controls.Persona.Strings.colonString=":",Office.Controls.Persona.Strings.suspensionPoints="...",Office.Controls.Persona.res={},Office.Controls.PersonaConstants.SectionTag_Main="persona-section-tag-main",Office.Controls.PersonaConstants.SectionTag_Action="ms-PersonaCard-action",Office.Controls.PersonaConstants.SectionTag_ActionDetail="ms-PersonaCard-actionDetails"}();