!function(){"use strict";window.Type&&window.Type.registerNamespace?Type.registerNamespace("Office.Controls"):(void 0===window.Office&&(window.Office={},window.Office.namespace=!0),void 0===window.Office.Controls&&(window.Office.Controls={},window.Office.Controls.namespace=!0)),Office.Controls.Persona=function(e,s,t,o){try{if("object"!=typeof e||"object"!=typeof t||Office.Controls.Utils.isNullOrUndefined(s))return void Office.Controls.Utils.errorConsole("Invalid parameters type");this.root=e,this.templateID=s,this.dataProvider=t,this.isHidden=o,this.currentNode=null,this.loadTemplate()}catch(r){throw r}},Office.Controls.Persona.prototype={delaySearchInterval:300,onError:null,dataProvider:null,showErrors:!0,errorMessageElement:null,alertDiv:null,currentToken:null,widthSet:!1,hasErrors:!1,errorDisplayed:null,isCreated:!0,oriID:"",getErrorDisplayed:function(){return this.errorDisplayed},loadTemplate:function(){var e=this,s=new XMLHttpRequest;s.open("GET","control/templates/template.htm",!0),s.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var s,t;window.DOMParser?(s=new DOMParser,t=s.parseFromString(this.responseText,"text/xml")):(t=new ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.loadXML(this.responseText));var o=t.getElementById(e.templateID),r=document.createElement("div");e.hiddenNode(r,e.isHidden),r.innerHTML=e.bindData(o.innerHTML),e.root.appendChild(r),e.currentNode=r}},s.send()},bindData:function(e){for(var s=/\$\{([^\}\{]+)\}/g,t=e,o=this.dataProvider,r=t.match(s),n=0;n<r.length;n++){var a=o[r[n].substring(2,r[n].length-1)];t=t.replace(r[n],a)}return t},hiddenNode:function(e,s){s?(e.style.visibility="",e.style.display=""):(e.style.visibility="hidden",e.style.display="none")},removeDetailCard:function(){},setActiveStyle:function(e,s){for(var t=e||window.event,o=t.target||t.srcElement,r=" is-active",n=Office.Controls.PersonaConstants.ClassName_PersonaCardAction,a=PersonaConstants.ClassName_PersonaCardActionDetails,i=document.getElementsByClassName(n),l=0;l<i.length;l++)i[l].className=i[l].className.replace(r,"");for(var c=document.getElementsByClassName(a),l=0;l<c.length;l++)c[l].className=c[l].className.replace(r,"");if(-1==o.className.indexOf(r)||oriID!=s){o.className+=r;var f=document.getElementById(s);f.className+=r,this.oriID=s}else this.oriID=""}},Office.Controls.PersonaResources=function(){},Office.Controls.PersonaConstants=function(){},Office.Controls.Persona.registerClass&&Office.Controls.Persona.registerClass("Office.Controls.Persona"),Office.Controls.PersonaConstants.registerClass&&Office.Controls.PersonaConstants.registerClass("Office.Controls.PersonaConstants"),Office.Controls.PersonaResources.registerClass&&Office.Controls.PersonaResources.registerClass("Office.Controls.PersonaResources"),Office.Controls.Persona.res={},Office.Controls.PersonaConstants.ClassName_PersonaCardAction="ms-PersonaCard-action",Office.Controls.PersonaConstants.ClassName_PersonaCardActionDetails="ms-PersonaCard-actionDetails",Office.Controls.PersonaResources.PersonaName="Persona"}();