!function(){"use strict";window.Type&&window.Type.registerNamespace?Type.registerNamespace("Office.Controls"):(void 0===window.Office&&(window.Office={},window.Office.namespace=!0),void 0===window.Office.Controls&&(window.Office.Controls={},window.Office.Controls.namespace=!0)),Office.Controls.Persona=function(e,n,s){try{if(Office.Controls.Utils.isNullOrUndefined(e)||Office.Controls.Utils.isNullOrUndefined(n))return void Office.Controls.Utils.errorConsole("Invalid parameters type");this.parentElementID=e,this.templateID=n,this.isHidden=s,this.currentNode=null,this.root=document.getElementById(e),this.loadTemplate(this.parentElementID,this.templateID,this.isHidden)}catch(t){throw t}},Office.Controls.Persona.prototype={delaySearchInterval:300,onError:null,dataProvider:null,showErrors:!0,errorMessageElement:null,alertDiv:null,currentToken:null,widthSet:!1,hasErrors:!1,errorDisplayed:null,isCreated:!0,oriID:"",getErrorDisplayed:function(){return this.errorDisplayed},getDisplayInfoAsync:function(e,n){},renderControl:function(e){},loadTemplate:function(e,n,s){var t=this,o=new XMLHttpRequest;o.open("GET","control/templates/template.htm",!0),o.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var e,o;window.DOMParser?(e=new DOMParser,o=e.parseFromString(this.responseText,"text/xml")):(o=new ActiveXObject("Microsoft.XMLDOM"),o.async=!1,o.loadXML(this.responseText));var r=o.getElementById(n),a=document.createElement("div");t.hiddenNode(a,s),a.innerHTML=t.bindData(r.innerHTML),t.root.appendChild(a),t.currentNode=a}},o.send()},samplePersonInfo:function(){var e=new Array;return e.DisplayName="***REMOVED*** Chen",e.JobTitle="Software Engineer 2",e.ImageUrl="control/images/icon.png",e.Department="ASG EA China",e.Office="BEIJING-BJW-1/12329",e.Email="***REMOVED***@microsoft.com",e.SipAddress="***REMOVED***@microsoft.com",e.MobilePhone="+86 1861-2947-014",e.WorkPhone="+86(10) 59173216",e},bindData:function(e){for(var n=/\$\{([^\}\{]+)\}/g,s=e,t=this.samplePersonInfo(),o=s.match(n),r=0;r<o.length;r++){var a=t[o[r].substring(2,o[r].length-1)];s=s.replace(o[r],a)}return s},hiddenNode:function(e,n){n?(e.style.visibility="",e.style.display=""):(e.style.visibility="hidden",e.style.display="none")},showNameOnly:function(){loadTemplate("nameOnlyRoot","NameOnly",!0);var e=this;Office.Controls.Utils.addEventListener(this.root,"click",function(n){return e.showNameImage()})},showPersonaCard:function(){currentNode=loadTemplate("personaCardRoot","PersonaCard",!0)},removeDetailCard:function(){},createPersona:function(){loadTemplate("NameOnly",!0)},setActiveStyle:function(e,n){for(var s=e||window.event,t=s.target||s.srcElement,o=" is-active",r=Office.Controls.PersonaConstants.ClassName_PersonaCardAction,a=PersonaConstants.ClassName_PersonaCardActionDetails,i=document.getElementsByClassName(r),l=0;l<i.length;l++)i[l].className=i[l].className.replace(o,"");for(var c=document.getElementsByClassName(a),l=0;l<c.length;l++)c[l].className=c[l].className.replace(o,"");if(-1==t.className.indexOf(o)||oriID!=n){t.className+=o;var f=document.getElementById(n);f.className+=o,this.oriID=n}else this.oriID=""}},Office.Controls.PersonaResources=function(){},Office.Controls.PersonaConstants=function(){},Office.Controls.Persona.registerClass&&Office.Controls.Persona.registerClass("Office.Controls.Persona"),Office.Controls.PersonaConstants.registerClass&&Office.Controls.PersonaConstants.registerClass("Office.Controls.PersonaConstants"),Office.Controls.PersonaResources.registerClass&&Office.Controls.PersonaResources.registerClass("Office.Controls.PersonaResources"),Office.Controls.Persona.res={},Office.Controls.PersonaConstants.ClassName_PersonaCardAction="ms-PersonaCard-action",Office.Controls.PersonaConstants.ClassName_PersonaCardActionDetails="ms-PersonaCard-actionDetails",Office.Controls.PersonaResources.PersonaName="Persona"}();