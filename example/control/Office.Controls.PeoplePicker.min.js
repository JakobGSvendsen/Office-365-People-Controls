!function(){"use strict";window.Type&&window.Type.registerNamespace?Type.registerNamespace("Office.Controls"):(void 0===window.Office&&(window.Office={},window.Office.namespace=!0),void 0===window.Office.Controls&&(window.Office.Controls={},window.Office.Controls.namespace=!0)),Office.Controls.PrincipalInfo=function(){},Office.Controls.PeoplePickerRecord=function(){},Office.Controls.PeoplePickerRecord.prototype={isResolved:!1,text:null,displayName:null,Description:null,PersonId:null,imgSrc:null,principalInfo:null},Office.Controls.PeoplePicker=function(e,t,i){try{if("object"!=typeof e||"object"!=typeof t||!Office.Controls.Utils.isNullOrUndefined(i)&&"object"!=typeof i)return void Office.Controls.Utils.errorConsole("Invalid parameters type");this.root=e,this.dataProvider=t,Office.Controls.Utils.isNullOrUndefined(i)||(Office.Controls.Utils.isNullOrUndefined(i.allowMultipleSelections)||(this.allowMultiple="true"===String(i.allowMultipleSelections)),!Office.Controls.Utils.isNullOrUndefined(i.startSearchCharLength)&&i.startSearchCharLength>=1&&(this.startSearchCharLength=i.startSearchCharLength),Office.Controls.Utils.isNullOrUndefined(i.delaySearchInterval)||(this.delaySearchInterval=i.delaySearchInterval),Office.Controls.Utils.isNullOrUndefined(i.enableCache)||(this.enableCache="true"===String(i.enableCache)),Office.Controls.Utils.isNullOrUndefined(i.numberOfResults)||(this.numberOfResults=i.numberOfResults),Office.Controls.Utils.isNullOrEmptyString(i.inputHint)||(this.inputHint=i.inputHint),Office.Controls.Utils.isNullOrUndefined(i.showValidationErrors)||(this.showValidationErrors="true"===String(i.showValidationErrors)),Office.Controls.Utils.isNullOrUndefined(i.showImage)||(this.showImage="true"===String(i.showImage)),Office.Controls.Utils.isNullOrUndefined(i.onAdded)||(this.onAdded=i.onAdded),Office.Controls.Utils.isNullOrUndefined(i.onRemoved)||(this.onRemoved=i.onRemoved),Office.Controls.Utils.isNullOrUndefined(i.onChange)||(this.onChange=i.onChange),Office.Controls.Utils.isNullOrUndefined(i.onFocus)||(this.onFocus=i.onFocus),Office.Controls.Utils.isNullOrUndefined(i.onBlur)||(this.onBlur=i.onBlur),this.onError=i.onError,Office.Controls.Utils.isNullOrUndefined(i.resourceStrings)||(Office.Controls.PeoplePicker.res=i.resourceStrings)),this.currentTimerId=-1,this.selectedItems=new Array(0),this.internalSelectedItems=new Array(0),this.errors=new Array(0),this.enableCache===!0&&(Office.Controls.Runtime.initialize({HostUrl:window.location.host}),this.cache=Office.Controls.PeoplePicker.mruCache.getInstance()),this.renderControl(),this.autofill=new Office.Controls.PeoplePicker.autofillContainer(this)}catch(r){throw r}},Office.Controls.PeoplePicker.copyToRecord=function(e,t){e.DisplayName=t.DisplayName,e.Description=t.Description,e.PersonId=t.PersonId,e.imgSrc=t.imgSrc,e.principalInfo=t},Office.Controls.PeoplePicker.parseUserPaste=function(e){var t=e.indexOf("<"),i=e.indexOf("@",t),r=e.indexOf(">",i);return-1!==t&&-1!==i&&-1!==r?e.substring(t+1,r):e},Office.Controls.PeoplePicker.getSearchBoxClass=function(){return"ms-PeoplePicker-searchBox"},Office.Controls.PeoplePicker.nopAddRemove=function(){},Office.Controls.PeoplePicker.nopOperation=function(){},Office.Controls.PeoplePicker.create=function(e,t){return new Office.Controls.PeoplePicker(e,t)},Office.Controls.PeoplePicker.prototype={allowMultiple:!1,startSearchCharLength:1,delaySearchInterval:300,enableCache:!0,inputHint:null,numberOfResults:30,onAdded:Office.Controls.PeoplePicker.nopAddRemove,onRemoved:Office.Controls.PeoplePicker.nopAddRemove,onChange:Office.Controls.PeoplePicker.nopOperation,onFocus:Office.Controls.PeoplePicker.nopOperation,onBlur:Office.Controls.PeoplePicker.nopOperation,onError:null,dataProvider:null,showValidationErrors:!0,showImage:!1,showInputHint:!0,inputTabindex:0,searchingTimes:0,inputBeginAction:!1,actualRoot:null,textInput:null,inputData:null,defaultText:null,resolvedListRoot:null,autofillElement:null,errorMessageElement:null,root:null,lastSearchQuery:"",currentToken:null,widthSet:!1,currentPrincipalsChoices:null,hasErrors:!1,errorDisplayed:null,hasMultipleMatchValidationError:!1,hasNoMatchValidationError:!1,autofill:null,reset:function(){for(var e;this.internalSelectedItems.length;)e=this.internalSelectedItems[0],e.removeAndNotTriggerUserListener();this.setTextInputDisplayStyle(),this.validateMultipleMatchError(),this.validateNoMatchError(),this.clearInputField(),this.clearCacheData(),Office.Controls.PeoplePicker.autofillContainer.currentOpened&&Office.Controls.PeoplePicker.autofillContainer.currentOpened.close(),Office.Controls.PeoplePicker.autofillContainer.currentOpened=null,Office.Controls.PeoplePicker.autofillContainer.boolBodyHandlerAdded=!1,this.autofill=new Office.Controls.PeoplePicker.autofillContainer(this),this.toggleDefaultText()},remove:function(e){var t,i,r=this.internalSelectedItems;for(t=0;t<r.length;t++)if(r[t].Record.principalInfo===e){i=r[t].Record,r[t].removeAndNotTriggerUserListener(),this.onRemoved(this,i.principalInfo),this.validateMultipleMatchError(),this.validateNoMatchError(),this.setTextInputDisplayStyle(),this.textInput.focus();break}},add:function(e,t){if("string"==typeof e)this.addThroughString(e);else{var i=new Office.Controls.PeoplePickerRecord;Office.Controls.PeoplePicker.copyToRecord(i,e),i.text=e.DisplayName,Office.Controls.Utils.isNullOrUndefined(t)?(i.isResolved=!1,this.addThroughRecord(i,!1)):(i.isResolved=t,this.addThroughRecord(i,t))}},getAddedPeople:function(){var e,t=this.internalSelectedItems,i=[];for(e=0;e<t.length;e++)i[e]=t[e].Record.principalInfo;return i},clearCacheData:function(){null!==this.cache&&(this.cache.cacheDelete("Office.PeoplePicker.Cache"),this.cache.dataObject=new Office.Controls.PeoplePicker.mruCache.mruData,this.cache.dataObject.cacheMapping[Office.Controls.Runtime.context.HostUrl]=new Array(0))},getErrorDisplayed:function(){return this.errorDisplayed},getUserInfoAsync:function(e,t){var i=new Office.Controls.PeoplePickerRecord;this.dataProvider.getPrincipals(t,function(t,r){null!==r?(Office.Controls.PeoplePicker.copyToRecord(i,r[0]),e(i)):e(null)})},get_textInput:function(){return this.textInput},get_actualRoot:function(){return this.actualRoot},addThroughString:function(e){return Office.Controls.Utils.isNullOrEmptyString(e)?void Office.Controls.Utils.errorConsole("Input can't be null or empty string. PeoplePicker Id : "+this.root.id):void this.addUnresolvedPrincipal(e,!1)},addThroughRecord:function(e,t){t?this.addResolvedRecord(e):this.addUncertainPrincipal(e)},renderControl:function(e){this.root.innerHTML=Office.Controls.peoplePickerTemplates.generateControlTemplate(e,this.allowMultiple,this.inputHint),this.root.className.length>0&&(this.root.className+=" "),this.root.className+="office office-peoplepicker",this.actualRoot=this.root.querySelector("div.ms-PeoplePicker");var t=this;Office.Controls.Utils.addEventListener(this.actualRoot,"click",function(e){return t.onPickerClick(e)}),this.inputData=this.actualRoot.querySelector('input[type="hidden"]'),this.textInput=this.actualRoot.querySelector('input[type="text"]'),this.defaultText=this.actualRoot.querySelector("span.office-peoplepicker-default"),this.resolvedListRoot=this.actualRoot.querySelector("div.office-peoplepicker-recordList"),this.autofillElement=this.actualRoot.querySelector(".ms-PeoplePicker-results"),Office.Controls.Utils.addEventListener(this.textInput,"focus",function(e){return t.onInputFocus(e)}),Office.Controls.Utils.addEventListener(this.textInput,"blur",function(e){return t.onInputBlur(e)}),Office.Controls.Utils.addEventListener(this.textInput,"keydown",function(e){return t.onInputKeyDown(e)}),Office.Controls.Utils.addEventListener(this.textInput,"input",function(e){return t.onInput(e)}),Office.Controls.Utils.addEventListener(window.self,"resize",function(e){return t.onResize(e)}),this.toggleDefaultText(),Office.Controls.Utils.isNullOrUndefined(this.inputTabindex)||this.textInput.setAttribute("tabindex",this.inputTabindex)},toggleDefaultText:function(){this.defaultText.className=-1!==this.actualRoot.className.indexOf("office-peoplepicker-autofill-focus")||!this.showInputHint||this.selectedItems.length||this.textInput.value.length?"office-hide":"office-peoplepicker-default"},onResize:function(){return this.toggleDefaultText(),!0},onInputKeyDown:function(e){var t=Office.Controls.Utils.getEvent(e),i=this;if(27===t.keyCode)this.autofill.close();else if(9===t.keyCode&&this.autofill.IsDisplayed){var r=this.autofillElement.querySelector("li.ms-PeoplePicker-resultAddedForSelect");if(null!==r){var o=this.autofill.getPersonIdFromListElement(r);return this.addResolvedPrincipal(this.autofill.entries[o]),this.autofill.flushContent(),Office.Controls.Utils.cancelEvent(e),!1}this.autofill.close()}else{if((40===t.keyCode||38===t.keyCode)&&this.autofill.IsDisplayed)return this.autofill.onKeyDownFromInput(t),t.preventDefault(),t.stopPropagation(),Office.Controls.Utils.cancelEvent(e),!1;if(37===t.keyCode&&this.internalSelectedItems.length)return this.resolvedListRoot.lastChild.focus(),Office.Controls.Utils.cancelEvent(e),!1;if(8===t.keyCode){var n=!1;if(Office.Controls.Utils.isNullOrUndefined(document.selection)){var l=this.textInput.selectionStart,s=this.textInput.selectionEnd;l||l!==s||(n=!0)}else{var a=document.selection.createRange(),c=a.text,f=a.text.length;a.moveStart("character",-this.textInput.value.length),c.length||f||(n=!0)}n&&this.internalSelectedItems.length&&(this.internalSelectedItems[this.internalSelectedItems.length-1].remove(),Office.Controls.Utils.cancelEvent(e))}else{if(75===t.keyCode&&t.ctrlKey||186===t.keyCode||59===t.keyCode||13===t.keyCode)return t.preventDefault(),t.stopPropagation(),this.cancelLastRequest(),this.attemptResolveInput(),Office.Controls.Utils.cancelEvent(e),!1;if(86===t.keyCode&&t.ctrlKey||186===t.keyCode)return this.cancelLastRequest(),window.setTimeout(function(){i.textInput.value=Office.Controls.PeoplePicker.parseUserPaste(i.textInput.value),i.attemptResolveInput()},0),!0;13===t.keyCode&&t.shiftKey?this.autofill.open(function(e){i.addResolvedPrincipal(e)}):this.resizeInputField()}}return!0},cancelLastRequest:function(){window.clearTimeout(this.currentTimerId),Office.Controls.Utils.isNullOrUndefined(this.currentToken)||(this.hideLoadingIcon(),this.currentToken.cancel(),this.currentToken=null)},onInput:function(e){return this.startQueryAfterDelay(),this.resizeInputField(),this.autofill.close(),!0},displayCachedEntries:function(){var e=this.cache.get(this.textInput.value,5),t=this;this.autofill.setCachedEntries(e),e.length&&this.autofill.open(function(e){t.addResolvedPrincipal(e)})},resizeInputField:function(){var e=Math.max(this.textInput.value.length+1,1);this.textInput.size=e},clearInputField:function(){this.textInput.value="",this.resizeInputField()},startQueryAfterDelay:function(){this.cancelLastRequest();var e=this.textInput.value,t=this;this.currentTimerId=window.setTimeout(function(){if(e!==t.lastSearchQuery||0===t.startSearchCharLength){if(t.lastSearchQuery=e,e.length>=t.startSearchCharLength){t.searchingTimes++,t.displayLoadingIcon(e),t.removeValidationError("ServerProblem");var i=new Office.Controls.PeoplePicker.cancelToken;t.currentToken=i,t.dataProvider.getPrincipals(t.textInput.value,function(e,r){i.IsCanceled||(null!==r?t.onDataReceived(r):t.onDataFetchError(e))})}else t.autofill.close();t.enableCache&&t.displayCachedEntries()}},t.delaySearchInterval)},onDataFetchError:function(e){this.hideLoadingIcon(),this.addValidationError(Office.Controls.PeoplePicker.ValidationError.createServerProblemError())},onDataReceived:function(e){this.currentPrincipalsChoices={};var t,i=this;for(t=0;t<e.length;t++){var r=e[t];this.currentPrincipalsChoices[r.PersonId]=r}this.autofill.setServerEntries(e),this.hideLoadingIcon(),this.autofill.open(function(e){i.addResolvedPrincipal(e)})},onPickerClick:function(e){this.textInput.focus(),e=Office.Controls.Utils.getEvent(e);var t=Office.Controls.Utils.getTarget(e);return"input"!==t.nodeName.toLowerCase()&&this.focusToEnd(),!0},focusToEnd:function(){var e=this.textInput.value.length;if(Office.Controls.Utils.isNullOrUndefined(this.textInput.createTextRange))this.textInput.focus(),this.textInput.setSelectionRange(e,e);else{var t=this.textInput.createTextRange();t.collapse(!0),t.moveStart("character",e),t.moveEnd("character",e),t.select()}},onInputFocus:function(e){var t=this;return Office.Controls.Utils.isNullOrEmptyString(this.actualRoot.className)?this.actualRoot.className="office-peoplepicker-autofill-focus":this.actualRoot.className+=" office-peoplepicker-autofill-focus",this.widthSet||this.setInputMaxWidth(),this.toggleDefaultText(),this.onFocus(this),0!==this.startSearchCharLength||this.allowMultiple!==!0&&0!==this.internalSelectedItems.length||t.startQueryAfterDelay(),!0},setInputMaxWidth:function(){var e=this.actualRoot.clientWidth-25;0>=e&&(e=20),this.textInput.style.maxWidth=e.toString()+"px",this.widthSet=!0},onInputBlur:function(e){return Office.Controls.Utils.removeClass(this.actualRoot,"office-peoplepicker-autofill-focus"),this.textInput.value.length>0||this.selectedItems.length>0?(this.onBlur(this),!0):(this.toggleDefaultText(),this.onBlur(this),!0)},onDataSelected:function(e){this.lastSearchQuery="",this.clearInputField(),this.refreshInputField()},onDataRemoved:function(e){this.refreshInputField(),this.validateMultipleMatchError(),this.validateNoMatchError(),this.onRemoved(this,e.principalInfo),this.onChange(this)},addToCache:function(e){this.cache.isCacheAvailable&&this.cache.set(e)},refreshInputField:function(){this.inputData.value=Office.Controls.Utils.serializeJSON(this.selectedItems),this.setTextInputDisplayStyle()},setTextInputDisplayStyle:function(){this.allowMultiple||1!==this.internalSelectedItems.length?(this.textInput.removeAttribute("readonly"),this.textInput.className="ms-PeoplePicker-searchField ms-PeoplePicker-searchFieldAdded"):(this.textInput.className="ms-PeoplePicker-searchFieldAddedForSingleSelectionHidden",this.textInput.setAttribute("readonly","readonly"))},displayLoadingIcon:function(e){this.autofill.openSearchingLoadingStatus(e)},hideLoadingIcon:function(){this.autofill.closeSearchingLoadingStatus()},attemptResolveInput:function(){this.autofill.close(),this.textInput.value.length>0&&(this.lastSearchQuery="",this.addUnresolvedPrincipal(this.textInput.value,!0))},onDataReceivedForResolve:function(e,t){return this.hideLoadingIcon(),1===e.length?t.resolveTo(e[0]):t.setResolveOptions(e),this.refreshInputField(),t},onDataReceivedForStalenessCheck:function(e,t){1===e.length?t.resolveTo(e[0]):(t.unresolve(),t.setResolveOptions(e)),this.refreshInputField()},addResolvedPrincipal:function(e){var t=new Office.Controls.PeoplePickerRecord,i=new Office.Controls.PeoplePicker.internalPeoplePickerRecord(this,t);Office.Controls.PeoplePicker.copyToRecord(t,e),t.text=e.DisplayName,t.isResolved=!0,this.selectedItems.push(t),i.add(),i.updateHoverText(),this.internalSelectedItems.push(i),this.onDataSelected(t),this.enableCache&&this.addToCache(e),this.currentPrincipalsChoices=null,this.autofill.close(),this.textInput.focus(),this.onAdded(this,t.principalInfo),this.onChange(this)},addResolvedRecord:function(e){this.selectedItems.push(e);var t=new Office.Controls.PeoplePicker.internalPeoplePickerRecord(this,e);t.add(),t.updateHoverText(),this.internalSelectedItems.push(t),this.onDataSelected(e),this.onAdded(this,e.principalInfo),this.currentPrincipalsChoices=null},addUncertainPrincipal:function(e){this.selectedItems.push(e);var t=new Office.Controls.PeoplePicker.internalPeoplePickerRecord(this,e),i=this;t.add(),t.updateHoverText(),this.internalSelectedItems.push(t),this.setTextInputDisplayStyle(),this.displayLoadingIcon(e.text),this.dataProvider.getPrincipals(e.DisplayName,function(e,r){null!==r?(t=i.onDataReceivedForResolve(r,t),i.onAdded(this,t.Record.principalInfo),i.onChange(i)):i.onDataFetchError(e)})},addUnresolvedPrincipal:function(e,t){var i=new Office.Controls.PeoplePickerRecord,r=this,o=new Office.Controls.PrincipalInfo;o.displayName=e,i.text=e,i.principalInfo=o,i.isResolved=!1;var n=new Office.Controls.PeoplePicker.internalPeoplePickerRecord(this,i);n.add(),n.updateHoverText(),this.selectedItems.push(i),this.internalSelectedItems.push(n),this.clearInputField(),this.setTextInputDisplayStyle(),this.displayLoadingIcon(e),this.dataProvider.getPrincipals(e,function(e,i){null!==i?(n=r.onDataReceivedForResolve(i,n),t&&(r.onAdded(r,n.Record.principalInfo),r.onChange(r))):r.onDataFetchError(e)})},addValidationError:function(e){this.hasErrors=!0,this.errors.push(e),this.displayValidationErrors(),Office.Controls.Utils.isNullOrUndefined(this.onError)||this.onError(this,e)},removeValidationError:function(e){var t;for(t=0;t<this.errors.length;t++)if(this.errors[t].errorName===e){this.errors.splice(t,1);break}this.errors.length||(this.hasErrors=!1),!Office.Controls.Utils.isNullOrUndefined(this.onError)&&this.errors.length?this.onError(this,this.errors[0]):this.displayValidationErrors()},validateMultipleMatchError:function(){var e,t=this.hasMultipleMatchValidationError,i=!1;for(e=0;e<this.internalSelectedItems.length;e++)if(!Office.Controls.Utils.isNullOrUndefined(this.internalSelectedItems[e].optionsList)&&this.internalSelectedItems[e].optionsList.length>0){i=!0;break}!t&&i&&this.addValidationError(Office.Controls.PeoplePicker.ValidationError.createMultipleMatchError()),t&&!i&&this.removeValidationError("MultipleMatch"),this.hasMultipleMatchValidationError=i},validateNoMatchError:function(){var e,t=this.hasNoMatchValidationError,i=!1;for(e=0;e<this.internalSelectedItems.length;e++)if(!Office.Controls.Utils.isNullOrUndefined(this.internalSelectedItems[e].optionsList)&&!this.internalSelectedItems[e].optionsList.length){i=!0;break}!t&&i&&this.addValidationError(Office.Controls.PeoplePicker.ValidationError.createNoMatchError()),t&&!i&&this.removeValidationError("NoMatch"),this.hasNoMatchValidationError=i},displayValidationErrors:function(){if(this.showValidationErrors)if(this.errors.length){if(this.errorDisplayed!==this.errors[0]){Office.Controls.Utils.isNullOrUndefined(this.errorMessageElement)||this.errorMessageElement.parentNode.removeChild(this.errorMessageElement);var e=document.createElement("div");e.innerHTML=Office.Controls.peoplePickerTemplates.generateErrorTemplate(this.errors[0].localizedErrorMessage),this.errorMessageElement=e.firstChild,this.root.appendChild(this.errorMessageElement),this.errorDisplayed=this.errors[0]}}else Office.Controls.Utils.isNullOrUndefined(this.errorMessageElement)||(this.errorMessageElement.parentNode.removeChild(this.errorMessageElement),this.errorMessageElement=null,this.errorDisplayed=null)},setDataProvider:function(e){this.dataProvider=e}},Office.Controls.PeoplePicker.internalPeoplePickerRecord=function(e,t){this.parent=e,this.Record=t},Office.Controls.PeoplePicker.internalPeoplePickerRecord.prototype={Record:null,get_record:function(){return this.Record},set_record:function(e){return this.Record=e,e},_principalOptions:null,_optionsList:null,Node:null,get_node:function(){return this.Node},set_node:function(e){return this.Node=e,e},parent:null,onRecordRemovalClick:function(e){{var t=Office.Controls.Utils.getEvent(e);Office.Controls.Utils.getTarget(t)}return this.remove(),Office.Controls.Utils.cancelEvent(e),this.parent.autofill.close(),!1},onRecordRemovalKeyDown:function(e){var t=Office.Controls.Utils.getEvent(e);return(8===t.keyCode||13===t.keyCode||46===t.keyCode)&&(this.remove(),Office.Controls.Utils.cancelEvent(e),this.parent.autofill.close()),!1},onRecordKeyDown:function(e){{var t=Office.Controls.Utils.getEvent(e);Office.Controls.Utils.getTarget(t)}return 8===t.keyCode||13===t.keyCode||46===t.keyCode?(this.remove(),Office.Controls.Utils.cancelEvent(e),this.parent.autofill.close()):37===t.keyCode?(null!==this.Node.previousSibling&&this.Node.previousSibling.focus(),Office.Controls.Utils.cancelEvent(e)):39===t.keyCode&&(null!==this.Node.nextSibling?this.Node.nextSibling.focus():this.parent.textInput.focus(),Office.Controls.Utils.cancelEvent(e)),!1},add:function(){var e=document.createElement("div");e.innerHTML=Office.Controls.peoplePickerTemplates.generateRecordTemplate(this.Record,this.parent.allowMultiple,this.parent.showImage);var t=e.firstChild,i=t.querySelector("div.ms-PeoplePicker-personaRemove"),r=this;Office.Controls.Utils.addEventListener(t,"keydown",function(e){return r.onRecordKeyDown(e)}),Office.Controls.Utils.addEventListener(i,"click",function(e){return r.onRecordRemovalClick(e)}),Office.Controls.Utils.addEventListener(i,"keydown",function(e){return r.onRecordRemovalKeyDown(e)}),this.parent.resolvedListRoot.appendChild(t),this.parent.defaultText.className="office-hide",this.Node=t},remove:function(){this.removeAndNotTriggerUserListener(),this.parent.onDataRemoved(this.Record),this.parent.textInput.focus()},removeAndNotTriggerUserListener:function(){this.parent.resolvedListRoot.removeChild(this.Node);var e;for(e=0;e<this.parent.internalSelectedItems.length;e++)this.parent.internalSelectedItems[e]===this&&this.parent.internalSelectedItems.splice(e,1);for(e=0;e<this.parent.selectedItems.length;e++)this.parent.selectedItems[e]===this.Record&&this.parent.selectedItems.splice(e,1)},setResolveOptions:function(e){this.optionsList=e,this.principalOptions={};var t;for(t=0;t<e.length;t++)this.principalOptions[e[t].PersonId]=e[t];var i=this;Office.Controls.Utils.addEventListener(this.Node,"click",function(e){return i.onUnresolvedUserClick(e)}),this.parent.validateMultipleMatchError(),this.parent.validateNoMatchError()},onUnresolvedUserClick:function(e){e=Office.Controls.Utils.getEvent(e),this.parent.autofill.flushContent(),this.parent.autofill.setServerEntries(this.optionsList);var t=this;return this.parent.autofill.open(function(e){t.onAutofillClick(e)}),this.addKeyListenerForAutofill(),this.parent.autofill.focusOnFirstElement(),Office.Controls.Utils.cancelEvent(e),!1},addKeyListenerForAutofill:function(){var e,t=this.parent.autofill.root.querySelectorAll("li");for(e=0;e<t.length;e++){var i=t[e],r=this;Office.Controls.Utils.addEventListener(i,"keydown",function(e){return r.onAutofillKeyDown(e)})}},onAutofillKeyDown:function(e){var t=Office.Controls.Utils.getEvent(e),i=Office.Controls.Utils.getTarget(t);if(38===t.keyCode)if(null!==i.previousSibling)this.parent.autofill.changeFocus(i,i.previousSibling),i.previousSibling.focus();else if(null!==i.parentNode.parentNode.nextSibling){var r=this.parent.root.querySelectorAll("ul"),o=r[1];this.parent.autofill.changeFocus(i,o.lastChild),o.lastChild.focus()}else{var n=this.parent.root.querySelector("ul.ms-PeoplePicker-resultList");this.parent.autofill.changeFocus(i,n.lastChild),n.lastChild.focus()}else if(40===t.keyCode){if(null!==i.nextSibling)this.parent.autofill.changeFocus(i,i.nextSibling),i.nextSibling.focus();else if(null!==i.parentNode.parentNode.nextSibling){var r=this.parent.root.querySelectorAll("ul"),o=r[1];this.parent.autofill.changeFocus(i,o.firstChild),o.firstChild.focus()}}else if(9===t.keyCode){var l=this.parent.autofill.getPersonIdFromListElement(i);this.onAutofillClick(this.parent.autofill.entries[l]),Office.Controls.Utils.cancelEvent(e)}return!0},resolveTo:function(e){Office.Controls.PeoplePicker.copyToRecord(this.Record,e),this.Record.text=e.DisplayName,this.Record.isResolved=!0,this.parent.enableCache&&this.parent.addToCache(e),Office.Controls.Utils.removeClass(this.Node,"has-error");var t=this.Node.querySelector("div.ms-Persona-primaryText");t.innerHTML=Office.Controls.Utils.htmlEncode(e.DisplayName),this.updateHoverText()},refresh:function(e){Office.Controls.PeoplePicker.copyToRecord(this.Record,e),this.Record.text=e.DisplayName;var t=this.Node.querySelector("div.ms-Persona-primaryText");t.innerHTML=Office.Controls.Utils.htmlEncode(e.DisplayName)},unresolve:function(){this.Record.isResolved=!1;var e=this.Node.querySelector("div.ms-Persona-primaryText");e.innerHTML=Office.Controls.Utils.htmlEncode(this.Record.text),this.updateHoverText()},updateHoverText:function(){var e=this.Node.querySelector("div.ms-Persona-primaryText");e.title=Office.Controls.Utils.htmlEncode(this.Record.text),this.Node.querySelector("div.ms-PeoplePicker-personaRemove").title=Office.Controls.Utils.formatString(Office.Controls.peoplePickerTemplates.getString(Office.Controls.Utils.htmlEncode("PP_RemovePerson")),this.Record.text)},onAutofillClick:function(e){this.parent.onRemoved(this.parent,this.Record.principalInfo),this.resolveTo(e),this.parent.refreshInputField(),this.principalOptions=null,this.optionsList=null,this.parent.enableCache&&this.parent.addToCache(e),this.parent.validateMultipleMatchError(),this.parent.autofill.close(),this.parent.onAdded(this.parent,this.Record.principalInfo),this.parent.onChange(this.parent)}},Office.Controls.PeoplePicker.autofillContainer=function(e){this.entries={},this.cachedEntries=new Array(0),this.serverEntries=new Array(0),this.parent=e,this.root=e.autofillElement,Office.Controls.PeoplePicker.autofillContainer.boolBodyHandlerAdded||(Office.Controls.Utils.addEventListener(document.body,"click",function(e){return Office.Controls.PeoplePicker.autofillContainer.bodyOnClick(e)}),Office.Controls.PeoplePicker.autofillContainer.boolBodyHandlerAdded=!0)},Office.Controls.PeoplePicker.autofillContainer.getControlRootFromSubElement=function(e){for(;e&&"body"!==e.nodeName.toLowerCase();){if(-1!==e.className.indexOf("office office-peoplepicker"))return e;e=e.parentNode}return null},Office.Controls.PeoplePicker.autofillContainer.bodyOnClick=function(e){if(!Office.Controls.PeoplePicker.autofillContainer.currentOpened)return!0;var t=Office.Controls.Utils.getEvent(e),i=Office.Controls.Utils.getTarget(t),r=Office.Controls.PeoplePicker.autofillContainer.getControlRootFromSubElement(i);return i&&r===Office.Controls.PeoplePicker.autofillContainer.currentOpened.parent.root||Office.Controls.PeoplePicker.autofillContainer.currentOpened.close(),!0},Office.Controls.PeoplePicker.autofillContainer.prototype={_parent:null,_root:null,IsDisplayed:!1,get_isDisplayed:function(){return this.IsDisplayed},set_isDisplayed:function(e){return this.IsDisplayed=e,e},setCachedEntries:function(e){this.cachedEntries=e,this.entries={};var t,i=e.length;for(t=0;i>t;t++)this.entries[e[t].PersonId]=e[t]},getCachedEntries:function(){return this.cachedEntries},getServerEntries:function(){return this.serverEntries},setServerEntries:function(e){if(this.parent.enableCache===!0){var t,i=new Array(0),r=e.length;for(t=0;r>t;t++){var o=e[t];Office.Controls.Utils.isNullOrUndefined(this.entries[o.PersonId])&&(this.entries[e[t].PersonId]=e[t],i.push(o))}this.serverEntries=i}else{this.entries={};var t,r=e.length;for(t=0;r>t;t++)this.entries[e[t].PersonId]=e[t];this.serverEntries=e}},renderList:function(e){this.root.innerHTML=Office.Controls.peoplePickerTemplates.generateAutofillListTemplate(this.cachedEntries,this.serverEntries,this.parent.numberOfResults,this.parent.showImage);var t,i=!1,r=this.root.querySelectorAll("a"),o=this;for(t=0;t<r.length;t++){var n=r[t];Office.Controls.Utils.addEventListener(n,"click",function(t){return o.onEntryClick(t,e)}),Office.Controls.Utils.addEventListener(n,"focus",function(e){return o.onEntryFocus(e)}),Office.Controls.Utils.addEventListener(n,"blur",function(e){return o.onEntryBlur(e,i)})}var l=this.root.querySelectorAll("li");if(l.length>0&&Office.Controls.Utils.addClass(l[0],"ms-PeoplePicker-resultAddedForSelect"),this.parent.showImage)for(t=0;t<l.length;t++){var s=l[t],a=s.querySelector("img"),c=this.getPersonIdFromListElement(s);!function(e,t,i){e.parent.dataProvider.getImageAsync(i,function(r,o){null!=o&&(t.style.backgroundImage="url('"+o+"')",Office.Controls.Utils.isNullOrUndefined(e.entries[i])||(e.entries[i].imgSrc=o))})}(this,a,c)}},flushContent:function(){var e,t=this.root.querySelectorAll("div.ms-PeoplePicker-resultGroups");for(e=0;e<t.length;e++)this.root.removeChild(t[e]);this.entries={},this.serverEntries=new Array(0),this.cachedEntries=new Array(0)},open:function(e){this.renderList(e),this.IsDisplayed=!0,Office.Controls.PeoplePicker.autofillContainer.currentOpened=this,Office.Controls.Utils.containClass(this.parent.actualRoot,"is-active")||Office.Controls.Utils.addClass(this.parent.actualRoot,"is-active")},close:function(){this.IsDisplayed=!1,Office.Controls.Utils.removeClass(this.parent.actualRoot,"is-active")},openSearchingLoadingStatus:function(e){this.root.innerHTML=Office.Controls.peoplePickerTemplates.generateSerachingLoadingTemplate(),this.IsDisplayed=!0,Office.Controls.PeoplePicker.autofillContainer.currentOpened=this,Office.Controls.Utils.containClass(this.parent.actualRoot,"is-active")||Office.Controls.Utils.addClass(this.parent.actualRoot,"is-active")},closeSearchingLoadingStatus:function(){this.IsDisplayed=!1,Office.Controls.Utils.removeClass(this.parent.actualRoot,"is-active")},onEntryClick:function(e,t){var i=Office.Controls.Utils.getEvent(e),r=Office.Controls.Utils.getTarget(i),o=this.getParentListItem(r),n=this.getPersonIdFromListElement(o);return t(this.entries[n]),this.flushContent(),!0},focusOnFirstElement:function(){var e=this.root.querySelector("li.ms-PeoplePicker-result");Office.Controls.Utils.isNullOrUndefined(e)||e.focus()},onKeyDownFromInput:function(e){var t=this.root.querySelector("li.ms-PeoplePicker-resultAddedForSelect");if(38===e.keyCode)if(null!==t.previousSibling)this.changeFocus(t,t.previousSibling);else if(null!==t.parentNode.parentNode.nextSibling){var i=this.root.querySelectorAll("ul"),r=i[1];this.changeFocus(t,r.lastChild)}else{var o=this.root.querySelector("ul.ms-PeoplePicker-resultList");this.changeFocus(t,o.lastChild)}else if(40===e.keyCode)if(null!==t.nextSibling)this.changeFocus(t,t.nextSibling);else if(null!==t.parentNode.parentNode.nextSibling){var i=this.root.querySelectorAll("ul"),r=i[1];this.changeFocus(t,r.firstChild)}return!0},changeFocus:function(e,t){Office.Controls.Utils.removeClass(e,"ms-PeoplePicker-resultAddedForSelect"),Office.Controls.Utils.addClass(t,"ms-PeoplePicker-resultAddedForSelect")},getPersonIdFromListElement:function(e){return e.attributes.getNamedItem("data-office-peoplepicker-value").value},getParentListItem:function(e){for(;e&&"li"!==e.nodeName.toLowerCase();)e=e.parentNode;return e},onEntryFocus:function(e){var t=Office.Controls.Utils.getTarget(e);return t=this.getParentListItem(t),Office.Controls.Utils.containClass(t,"office-peoplepicker-autofill-focus")||Office.Controls.Utils.addClass(t,"office-peoplepicker-autofill-focus"),!1},onEntryBlur:function(e,t){var i=Office.Controls.Utils.getTarget(e);if(i=this.getParentListItem(i),Office.Controls.Utils.removeClass(i,"office-peoplepicker-autofill-focus"),t){var r=i.nextSibling;r&&r.nextSibling.className.toLowerCase()==="ms-PeoplePicker-searchMore js-searchMore".toLowerCase()&&Office.Controls.PeoplePicker.autofillContainer.currentOpened.close()}return!1}},Office.Controls.PeoplePicker.Parameters=function(){},Office.Controls.PeoplePicker.cancelToken=function(){this.IsCanceled=!1},Office.Controls.PeoplePicker.cancelToken.prototype={IsCanceled:!1,get_isCanceled:function(){return this.IsCanceled},set_isCanceled:function(e){return this.IsCanceled=e,e},cancel:function(){this.IsCanceled=!0}},Office.Controls.PeoplePicker.ValidationError=function(){},Office.Controls.PeoplePicker.ValidationError.createMultipleMatchError=function(){var e=new Office.Controls.PeoplePicker.ValidationError;return e.errorName="MultipleMatch",e.localizedErrorMessage=Office.Controls.peoplePickerTemplates.getString("PP_MultipleMatch"),e},Office.Controls.PeoplePicker.ValidationError.createNoMatchError=function(){var e=new Office.Controls.PeoplePicker.ValidationError;return e.errorName="NoMatch",e.localizedErrorMessage=Office.Controls.peoplePickerTemplates.getString("PP_NoMatch"),e},Office.Controls.PeoplePicker.ValidationError.createServerProblemError=function(){var e=new Office.Controls.PeoplePicker.ValidationError;return e.errorName="ServerProblem",e.localizedErrorMessage=Office.Controls.peoplePickerTemplates.getString("PP_ServerProblem"),
e},Office.Controls.PeoplePicker.ValidationError.prototype={errorName:null,localizedErrorMessage:null},Office.Controls.PeoplePicker.mruCache=function(){this.isCacheAvailable=this.checkCacheAvailability(),this.isCacheAvailable&&this.initializeCache()},Office.Controls.PeoplePicker.mruCache.getInstance=function(){return Office.Controls.PeoplePicker.mruCache.instance||(Office.Controls.PeoplePicker.mruCache.instance=new Office.Controls.PeoplePicker.mruCache),Office.Controls.PeoplePicker.mruCache.instance},Office.Controls.PeoplePicker.mruCache.prototype={isCacheAvailable:!1,_localStorage:null,_dataObject:null,get:function(e,t){(Office.Controls.Utils.isNullOrUndefined(t)||!t)&&(t=2147483647);var i,r=0,o=new Array(0),n=this.dataObject.cacheMapping[Office.Controls.Runtime.context.HostUrl],l=n.length;for(i=l;i>0&&t>r;i--){var s=n[i-1];this.entityMatches(s,e)&&(o.push(s),r+=1)}return o},set:function(e){var t,i=this.dataObject.cacheMapping[Office.Controls.Runtime.context.HostUrl],r=i.length,o=!1;for(t=0;r>t;t++){var n=i[t];if(n.PersonId===e.PersonId){i.splice(t,1),o=!0;break}}o||r>=200&&i.splice(0,1),i.push(e),this.cacheWrite("Office.PeoplePicker.Cache",Office.Controls.Utils.serializeJSON(this.dataObject))},entityMatches:function(e,t){if(Office.Controls.Utils.isNullOrEmptyString(t)||Office.Controls.Utils.isNullOrUndefined(e))return!1;t=t.toLowerCase();var i=e.PersonId;Office.Controls.Utils.isNullOrUndefined(i)&&(i="");var r=i.indexOf("\\");-1!==r&&r!==i.length-1&&(i=i.substr(r+1));var o=e.Email;Office.Controls.Utils.isNullOrUndefined(o)&&(o="");var n=o.indexOf("@");return-1!==n&&(o=o.substr(0,n)),Office.Controls.Utils.isNullOrUndefined(e.DisplayName)&&(e.DisplayName=""),i.toLowerCase().indexOf(t)&&o.toLowerCase().indexOf(t)&&e.DisplayName.toLowerCase().indexOf(t)?!1:!0},initializeCache:function(){var e=this.cacheRetreive("Office.PeoplePicker.Cache");if(Office.Controls.Utils.isNullOrEmptyString(e))this.dataObject=new Office.Controls.PeoplePicker.mruCache.mruData;else{var t=Office.Controls.Utils.deserializeJSON(e);t.cacheVersion?(this.dataObject=new Office.Controls.PeoplePicker.mruCache.mruData,this.cacheDelete("Office.PeoplePicker.Cache")):this.dataObject=t}Office.Controls.Utils.isNullOrUndefined(this.dataObject.cacheMapping[Office.Controls.Runtime.context.HostUrl])&&(this.dataObject.cacheMapping[Office.Controls.Runtime.context.HostUrl]=new Array(0))},checkCacheAvailability:function(){try{return"undefined"==typeof window.self.localStorage?!1:(this.localStorage=window.self.localStorage,!0)}catch(e){return!1}},cacheRetreive:function(e){return this.localStorage.getItem(e)},cacheWrite:function(e,t){this.localStorage.setItem(e,t)},cacheDelete:function(e){this.localStorage.removeItem(e)}},Office.Controls.PeoplePicker.mruCache.mruData=function(){this.cacheMapping={},this.cacheVersion=0},Office.Controls.PeoplePickerResourcesDefaults=function(){},Office.Controls.peoplePickerTemplates=function(){},Office.Controls.peoplePickerTemplates.getString=function(e){var t="PeoplePicker"+e.substr(3);return Office.Controls.PeoplePicker.res.hasOwnProperty("newName")?Office.Controls.PeoplePicker.res[t]:Office.Controls.Utils.getStringFromResource("PeoplePicker",e)},Office.Controls.peoplePickerTemplates.getDefaultText=function(e){return Office.Controls.peoplePickerTemplates.getString(e?"PP_DefaultMessagePlural":"PP_DefaultMessage")},Office.Controls.peoplePickerTemplates.generateControlTemplate=function(e,t,i){var r;r=Office.Controls.Utils.htmlEncode(Office.Controls.Utils.isNullOrEmptyString(i)?Office.Controls.peoplePickerTemplates.getDefaultText(t):i);var o='<div class="ms-PeoplePicker">';return o+='<input type="hidden"',Office.Controls.Utils.isNullOrEmptyString(e)||(o+=' name="'+Office.Controls.Utils.htmlEncode(e)+'"'),o+="/>",o+='<div class="ms-PeoplePicker-searchBox ms-PeoplePicker-searchBoxAdded">',o+='<span class="office-peoplepicker-default">'+r+"</span>",o+='<div class="office-peoplepicker-recordList"></div>',o+='<input type="text" class="ms-PeoplePicker-searchField" size="1" autocorrect="off" autocomplete="off" autocapitalize="off" />',o+="</div>",o+='<div class="ms-PeoplePicker-results">',o+="</div>",o+=Office.Controls.peoplePickerTemplates.generateAlertNode(),o+="</div>"},Office.Controls.peoplePickerTemplates.generateErrorTemplate=function(e){var t='<span class="office-peoplepicker-error">';return t+=Office.Controls.Utils.htmlEncode(e),t+="</span>"},Office.Controls.peoplePickerTemplates.generateAutofillListItemTemplate=function(e,t,i){var r=Office.Controls.Utils.htmlEncode(Office.Controls.Utils.isNullOrEmptyString(e.Email)?"":e.Email),o='<li tabindex="0" class="ms-PeoplePicker-result" data-office-peoplepicker-value="'+Office.Controls.Utils.htmlEncode(e.PersonId)+'" title="'+r+'">';return o+='<div class="ms-Persona ms-PersonaAdded">',i&&(o+=t&&!Office.Controls.Utils.isNullOrUndefined(e.imgSrc)?'<img class="ms-Persona-image" style="background-image:url(\''+e.imgSrc+"')\">":'<img class="ms-Persona-image">'),o+='<div class="ms-Persona-details">',o+='<a onclick="return false;" href="#" tabindex="-1">',o+='<div class="ms-Persona-primaryText" >'+Office.Controls.Utils.htmlEncode(e.DisplayName)+"</div>",Office.Controls.Utils.isNullOrEmptyString(e.Description)||(o+='<div class="ms-Persona-secondaryText" >'+Office.Controls.Utils.htmlEncode(e.Description)+"</div>"),o+="</a></div></div></li>"},Office.Controls.peoplePickerTemplates.generateAutofillListTemplate=function(e,t,i,r){var o='<div class="ms-PeoplePicker-resultGroups">',n=e.length+t.length;return Office.Controls.Utils.isNullOrUndefined(e)&&(e=new Array(0)),(Office.Controls.Utils.isNullOrUndefined(t)||e.length>=i)&&(t=new Array(0)),n>i&&e.length<i&&(t=t.slice(0,i-e.length)),o+=Office.Controls.peoplePickerTemplates.generateAutofillGroupTemplate(e,!0,r,!0),o+=Office.Controls.peoplePickerTemplates.generateAutofillGroupTemplate(t,!1,r,e.length>0),o+="</div>",o+=Office.Controls.peoplePickerTemplates.generateAutofillFooterTemplate(n,i)},Office.Controls.peoplePickerTemplates.generateAutofillGroupTemplate=function(e,t,i,r){var o,n="",l=Office.Controls.Utils.htmlEncode(Office.Controls.peoplePickerTemplates.getString("PP_SearchResultRecentGroup")),s=Office.Controls.Utils.htmlEncode(Office.Controls.peoplePickerTemplates.getString("PP_SearchResultMoreGroup")),a=t?l:s;if(!e.length)return n;for(n+='<div class="ms-PeoplePicker-resultGroup">',r&&(n+='<div class="ms-PeoplePicker-resultGroupTitle">'+a+"</div>"),n+='<ul class="ms-PeoplePicker-resultList" id="'+a+'">',o=0;o<e.length;o++)n+=Office.Controls.peoplePickerTemplates.generateAutofillListItemTemplate(e[o],t,i);return n+="</ul></div>"},Office.Controls.peoplePickerTemplates.generateAutofillFooterTemplate=function(e,t){var i='<div class="ms-PeoplePicker-searchMore js-searchMore">';i+='<div class="ms-PeoplePicker-searchMoreIcon"></div>';var r;return r=e>=t?Office.Controls.Utils.formatString(Office.Controls.peoplePickerTemplates.getString("PP_ShowingTopNumberOfResults"),t.toString()):e>1?Office.Controls.Utils.formatString(Office.Controls.peoplePickerTemplates.getString("PP_MultipleResults"),e.toString()):e>0?Office.Controls.Utils.formatString(Office.Controls.peoplePickerTemplates.getString("PP_SingleResult"),e.toString()):Office.Controls.peoplePickerTemplates.getString("PP_NoResult"),r=Office.Controls.Utils.htmlEncode(r),i+='<div class="ms-PeoplePicker-searchMorePrimary ms-PeoplePicker-searchMorePrimaryAdded">'+r+"</div>",i+="</div>"},Office.Controls.peoplePickerTemplates.generateSerachingLoadingTemplate=function(){var e=Office.Controls.Utils.htmlEncode(Office.Controls.peoplePickerTemplates.getString("PP_Searching")),t='<div class="ms-PeoplePicker-searchMore js-searchMore is-searching">';return t+='<div class="ms-PeoplePicker-searchMoreIconFixed"></div>',t+='<div class="ms-PeoplePicker-searchMorePrimary ms-PeoplePicker-searchMorePrimaryAdded">'+e+"</div>",t+="</div>"},Office.Controls.peoplePickerTemplates.generateRecordTemplate=function(e,t,i){var r,o="ms-PeoplePicker-persona";return t||(o+=" ms-PeoplePicker-personaForSingleAdded"),r=e.isResolved?'<div class="'+o+'" tabindex="0">':'<div class="'+o+' has-error" tabindex="0">',r+='<div class="ms-Persona ms-Persona--xs" >',i&&(r+=Office.Controls.Utils.isNullOrUndefined(e.imgSrc)?'<img class="ms-Persona-image">':'<img class="ms-Persona-image" style="background-image:url(\''+e.imgSrc+"')\">"),r+='<div class="ms-Persona-details">',r+='<div class="ms-Persona-primaryText ms-Persona-primaryTextForResolvedUserAdded">'+Office.Controls.Utils.htmlEncode(e.text),r+="</div></div></div>",r+=i?'<div class="ms-PeoplePicker-personaRemove ms-PeoplePicker-personaRemoveWithImage">':'<div class="ms-PeoplePicker-personaRemove ms-PeoplePicker-personaRemoveNoImage">',r+='<i tabindex="0" class="ms-Icon ms-Icon--x ms-Icon-added">',r+="</i></div>",r+="</div>"},Office.Controls.peoplePickerTemplates.generateAlertNode=function(){var e='<div role="alert" class="office-peoplepicker-alert">';return e+="</div>"},Office.Controls.Context=function(e){if("object"!=typeof e)return void Office.Controls.Utils.errorConsole("Invalid parameters type");var t=e.HostUrl;if(Office.Controls.Utils.isNullOrUndefined(t)){var i=Office.Controls.Utils.getQueryStringParameter("SPHostUrl");Office.Controls.Utils.isNullOrEmptyString(i)||(i=decodeURIComponent(i)),this.HostUrl=i}else this.HostUrl=t;this.HostUrl=this.HostUrl.toLocaleLowerCase()},Office.Controls.Context.prototype={HostUrl:null},Office.Controls.Runtime=function(){},Office.Controls.Runtime.initialize=function(e){Office.Controls.Runtime.context=new Office.Controls.Context(e)},Office.Controls.Utils=function(){},Office.Controls.Utils.deserializeJSON=function(e){return Office.Controls.Utils.isNullOrEmptyString(e)?{}:JSON.parse(e)},Office.Controls.Utils.serializeJSON=function(e){return JSON.stringify(e)},Office.Controls.Utils.isNullOrEmptyString=function(e){var t=null;return e===t||void 0===e||!e.length},Office.Controls.Utils.isNullOrUndefined=function(e){var t=null;return e===t||void 0===e},Office.Controls.Utils.getQueryStringParameter=function(e){if(document.URL.split("?").length<2)return null;var t,i=document.URL.split("?")[1].split("#")[0].split("&");for(t=0;t<i.length;t+=1){var r=i[t].split("=");if(r[0].toLowerCase()===e.toLowerCase())return r[1]}return null},Office.Controls.Utils.logConsole=function(e){console.log(e)},Office.Controls.Utils.warnConsole=function(e){console.warn(e)},Office.Controls.Utils.errorConsole=function(e){console.error(e)},Office.Controls.Utils.getObjectFromFullyQualifiedName=function(e){var t,i=window.self,r=e.split(".");for(t=0;t<r.length;t++)if(i=i[r[t]],Office.Controls.Utils.isNullOrUndefined(i))return null;return i},Office.Controls.Utils.getStringFromResource=function(e,t){{var i,r="Office.Controls."+e+"Resources";t.charAt(0).toString().toLowerCase()+t.substr(1)}return r+="Defaults",i=Office.Controls.Utils.getObjectFromFullyQualifiedName(r),Office.Controls.Utils.isNullOrUndefined(i)?t:i[t]},Office.Controls.Utils.addEventListener=function(e,t,i){var r=function(e){try{return i(e)}catch(t){throw t}};Office.Controls.Utils.isNullOrUndefined(e.addEventListener)?Office.Controls.Utils.isNullOrUndefined(e.attachEvent)||e.attachEvent("on"+t,r):e.addEventListener(t,r,!1)},Office.Controls.Utils.getEvent=function(e){return Office.Controls.Utils.isNullOrUndefined(e)?window.event:e},Office.Controls.Utils.getTarget=function(e){return Office.Controls.Utils.isNullOrUndefined(e.target)?e.srcElement:e.target},Office.Controls.Utils.cancelEvent=function(e){Office.Controls.Utils.isNullOrUndefined(e.cancelBubble)||(e.cancelBubble=!0),Office.Controls.Utils.isNullOrUndefined(e.stopPropagation)||e.stopPropagation(),Office.Controls.Utils.isNullOrUndefined(e.preventDefault)||e.preventDefault(),Office.Controls.Utils.isNullOrUndefined(e.returnValue)||(e.returnValue=!1),Office.Controls.Utils.isNullOrUndefined(e.cancel)||(e.cancel=!0)},Office.Controls.Utils.addClass=function(e,t){""!==e.className&&(e.className+=" "),e.className+=t},Office.Controls.Utils.removeClass=function(e,t){var i=new RegExp("( |^)"+t+"( |$)");e.className=e.className.replace(i," ").trim()},Office.Controls.Utils.containClass=function(e,t){return-1!==e.className.indexOf(t)},Office.Controls.Utils.cloneData=function(e){return Office.Controls.Utils.deserializeJSON(Office.Controls.Utils.serializeJSON(e))},Office.Controls.Utils.formatString=function(e){var t,i=[];for(t=1;t<arguments.length;++t)i[t-1]=arguments[t];for(var r="",o=0;o<e.length;){var n=Office.Controls.Utils.findPlaceHolder(e,o,"{");if(0>n){r+=e.substr(o);break}var l=Office.Controls.Utils.findPlaceHolder(e,n,"}");if(!(l>n))return Office.Controls.Utils.errorConsole("Invalid Operation"),null;r+=e.substr(o,n-o);var s=e.substr(n+1,l-n-1),a=parseInt(s);r+=i[a],o=l+1}return r},Office.Controls.Utils.findPlaceHolder=function(e,t,i){for(var r=e.indexOf(i,t);r>=0&&r<e.length-1&&e.charAt(r+1)===i;)t=r+2,r=e.indexOf(i,t);return r},Office.Controls.Utils.htmlEncode=function(e){return e=e.replace(new RegExp("&","g"),"&amp;"),e=e.replace(new RegExp('"',"g"),"&quot;"),e=e.replace(new RegExp("'","g"),"&#39;"),e=e.replace(new RegExp("<","g"),"&lt;"),e=e.replace(new RegExp(">","g"),"&gt;")},Office.Controls.Utils.getLocalizedCountValue=function(e,t,i){var r,o,n="",l=-1,s=t.split("||");for(r=0,o=s.length;o>r;r++){var a=s[r];if(!Office.Controls.Utils.isNullOrEmptyString(a)){var c,f,u=a.split(",");for(c=0,f=u.length;f>c;c++){var d=u[c];if(!Office.Controls.Utils.isNullOrEmptyString(d))if(isNaN(Number(d))){var p=d.split("-");if(Office.Controls.Utils.isNullOrUndefined(p)||2!==p.length)continue;var h,C;if(""===p[0])h=0;else{if(isNaN(Number(p[0])))continue;h=parseInt(p[0])}if(i>=h){if(""===p[1]){l=r;break}if(isNaN(Number(p[1])))continue;if(C=parseInt(p[1]),C>=i){l=r;break}}}else{var P=parseInt(d);if(i===P){l=r;break}}}if(-1!==l)break}}var O=e.split("||");return-1!==l&&(n=O[l]),n},Office.Controls.Utils.NOP=function(){},Office.Controls.PeoplePickerAadDataProvider=function(e){this.authContext=e},Office.Controls.PeoplePickerAadDataProvider.prototype={maxResult:50,authContext:null,getPrincipals:function(e,t){var i=this;i.authContext.acquireToken(Office.Controls.Utils.aadGraphResourceId,function(r,o){if(r||!o)return void t("Error",null);var n=i.authContext._extractIdToken(o),l="";n&&n.hasOwnProperty("tid")&&(l=n.tid);var s=new XMLHttpRequest;s.open("GET","https://graph.windows.net/"+l+"/users?api-version=1.5&$filter=startswith(displayName,"+encodeURIComponent("'"+e+"') or ")+"startswith(userPrincipalName,"+encodeURIComponent("'"+e+"')"),!0),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Authorization","Bearer "+o),s.onabort=s.onerror=s.ontimeout=function(){t("Error",null)},s.onload=function(){if(401===s.status)return void t("Unauthorized",null);if(200!==s.status)return void t("Unknown error",null);var e=JSON.parse(s.responseText),r=[];return void 0!==e["odata.error"]?void t(e["odata.error"],null):(e.value.forEach(function(e){var t={};t.DisplayName=e.displayName,t.Description=e.department,t.PersonId=e.objectId,r.push(t)}),r.length>i.maxResult&&(r=r.slice(0,i.maxResult)),void t(null,r))},s.send("")})},getImageAsync:function(e,t){var i=this;i.authContext.acquireToken(Office.Controls.Utils.aadGraphResourceId,function(r,o){if(r||!o)return void t("Error",null);var n=i.authContext._extractIdToken(o),l="";n&&n.hasOwnProperty("tid")&&(l=n.tid);var s=new XMLHttpRequest;s.open("GET","https://graph.windows.net/"+l+"/users/"+e+"/thumbnailPhoto?api-version=1.5"),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Authorization","Bearer "+o),s.responseType="blob",s.onabort=s.onerror=s.ontimeout=function(){t("Error",null)},s.onload=function(){if(401===s.status)return void t("Unauthorized",null);if(200!==s.status)return void t("Unknown error",null);var e=new FileReader;e.addEventListener("loadend",function(){t(null,e.result)}),e.readAsDataURL(s.response)},s.send("")})}},Office.Controls.PrincipalInfo.registerClass&&Office.Controls.PrincipalInfo.registerClass("Office.Controls.PrincipalInfo"),Office.Controls.PeoplePickerRecord.registerClass&&Office.Controls.PeoplePickerRecord.registerClass("Office.Controls.PeoplePickerRecord"),Office.Controls.PeoplePicker.registerClass&&Office.Controls.PeoplePicker.registerClass("Office.Controls.PeoplePicker"),Office.Controls.PeoplePicker.internalPeoplePickerRecord.registerClass&&Office.Controls.PeoplePicker.internalPeoplePickerRecord.registerClass("Office.Controls.PeoplePicker.internalPeoplePickerRecord"),Office.Controls.PeoplePicker.autofillContainer.registerClass&&Office.Controls.PeoplePicker.autofillContainer.registerClass("Office.Controls.PeoplePicker.autofillContainer"),Office.Controls.PeoplePicker.Parameters.registerClass&&Office.Controls.PeoplePicker.Parameters.registerClass("Office.Controls.PeoplePicker.Parameters"),Office.Controls.PeoplePicker.cancelToken.registerClass&&Office.Controls.PeoplePicker.cancelToken.registerClass("Office.Controls.PeoplePicker.cancelToken"),Office.Controls.PeoplePicker.ValidationError.registerClass&&Office.Controls.PeoplePicker.ValidationError.registerClass("Office.Controls.PeoplePicker.ValidationError"),Office.Controls.PeoplePicker.mruCache.registerClass&&Office.Controls.PeoplePicker.mruCache.registerClass("Office.Controls.PeoplePicker.mruCache"),Office.Controls.PeoplePicker.mruCache.mruData.registerClass&&Office.Controls.PeoplePicker.mruCache.mruData.registerClass("Office.Controls.PeoplePicker.mruCache.mruData"),Office.Controls.PeoplePickerResourcesDefaults.registerClass&&Office.Controls.PeoplePickerResourcesDefaults.registerClass("Office.Controls.PeoplePickerResourcesDefaults"),Office.Controls.peoplePickerTemplates.registerClass&&Office.Controls.peoplePickerTemplates.registerClass("Office.Controls.peoplePickerTemplates"),Office.Controls.Context.registerClass&&Office.Controls.Context.registerClass("Office.Controls.Context"),Office.Controls.Runtime.registerClass&&Office.Controls.Runtime.registerClass("Office.Controls.Runtime"),Office.Controls.Utils.registerClass&&Office.Controls.Utils.registerClass("Office.Controls.Utils"),Office.Controls.PeoplePicker.res={},Office.Controls.PeoplePicker.autofillContainer.currentOpened=null,Office.Controls.PeoplePicker.autofillContainer.boolBodyHandlerAdded=!1,Office.Controls.PeoplePicker.ValidationError.multipleMatchName="MultipleMatch",Office.Controls.PeoplePicker.ValidationError.noMatchName="NoMatch",Office.Controls.PeoplePicker.ValidationError.serverProblemName="ServerProblem",Office.Controls.PeoplePicker.mruCache.instance=null,Office.Controls.PeoplePickerResourcesDefaults.PP_NoMatch="We couldn't find an exact match.",Office.Controls.PeoplePickerResourcesDefaults.PP_ServerProblem="Sorry, we're having trouble reaching the server.",Office.Controls.PeoplePickerResourcesDefaults.PP_DefaultMessagePlural="Enter names or email addresses...",Office.Controls.PeoplePickerResourcesDefaults.PP_MultipleMatch="Multiple entries matched, please click to resolve.",Office.Controls.PeoplePickerResourcesDefaults.PP_NoResult="No results found",Office.Controls.PeoplePickerResourcesDefaults.PP_SingleResult="Showing {0} result",Office.Controls.PeoplePickerResourcesDefaults.PP_MultipleResults="Showing {0} results",Office.Controls.PeoplePickerResourcesDefaults.PP_ShowingTopNumberOfResults="Showing top {0} results",Office.Controls.PeoplePickerResourcesDefaults.PP_Searching="Searching...",Office.Controls.PeoplePickerResourcesDefaults.PP_RemovePerson="Remove person or group {0}",Office.Controls.PeoplePickerResourcesDefaults.PP_DefaultMessage="Enter a name or email address...",Office.Controls.PeoplePickerResourcesDefaults.PP_SearchResultRecentGroup="Recent",Office.Controls.PeoplePickerResourcesDefaults.PP_SearchResultMoreGroup="More",Office.Controls.Runtime.context=null,Office.Controls.Utils.oDataJSONAcceptString="application/json;odata=verbose",Office.Controls.Utils.clientTagHeaderName="X-ClientService-ClientTag",Office.Controls.Utils.aadGraphResourceId="00000002-0000-0000-c000-000000000000"}();