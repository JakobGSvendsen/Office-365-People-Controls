!function(){"use strict";window.Type&&window.Type.registerNamespace?Type.registerNamespace("Office.Controls"):(void 0===window.Office&&(window.Office={},window.Office.namespace=!0),void 0===window.Office.Controls&&(window.Office.Controls={},window.Office.Controls.namespace=!0)),Office.Controls.PeopleAadDataProvider=function(){this.authContext=authContext},Office.Controls.PeopleAadDataProvider.prototype={maxResult:50,lastErrorMessage:null,severHost:"localhost:3000",acquireToken:"00000002-0000-0000-c000-000000000000",apiVersion:"api-version=1.5",getUsersAsync:function(e,t){var n=this;n.authContext.acquireToken(n.acquireToken,function(o,r){if(o||!r)return void t("Error",null);var a=n.authContext._extractIdToken(r),i="";a&&a.hasOwnProperty("tid")&&(i=a.tid);var s=new XMLHttpRequest;s.open("GET","https://graph.windows.net/"+i+"/users?"+apiVersion+"&$filter=startswith(displayName,"+encodeURIComponent("'"+e+"') or ")+"startswith(userPrincipalName,"+encodeURIComponent("'"+e+"')"),!0),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Authorization","Bearer "+r),s.onabort=s.onerror=s.ontimeout=function(){t("Error",null)},s.onload=function(){if(401===s.status)return void t("Unauthorized",null);if(200!==s.status)return void t("Unknown error",null);var e=JSON.parse(s.responseText),o=[];return void 0!==e["odata.error"]?void t(e["odata.error"],null):(e.value.forEach(function(e){var t={};t.displayName=e.displayName,t.department=e.department,t.personId=e.objectId,o.push(t)}),o.length>n.maxResult&&(o=o.slice(0,n.maxResult)),void t(null,o))},s.send("")})},getUserImageAsync:function(e,t){var n=this;n.authContext.acquireToken(n.acquireToken,function(o,r){if(o||!r)return void t("Error",null);var a=n.authContext._extractIdToken(r),i="";a&&a.hasOwnProperty("tid")&&(i=a.tid);var s=new XMLHttpRequest;s.open("GET","https://graph.windows.net/"+i+"/users/"+e+"/thumbnailPhoto?"+apiVersion),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Authorization","Bearer "+r),s.responseType="blob",s.onabort=s.onerror=s.ontimeout=function(){t("Error",null)},s.onload=function(){if(401===s.status)return void t("Unauthorized",null);if(200!==s.status)return void t("Unknown error",null);var e=new FileReader;e.addEventListener("loadend",function(){t(null,e.result)}),e.readAsDataURL(s.response)},s.send("")})}}}();